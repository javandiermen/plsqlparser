D:\projects\plsqlcode\add_log_item.sql
(sql_script (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier (id_expression (regular_id ADD_LOG_ITEM)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_detail_level)))) IN (type_spec (datatype (native_datatype_element NUMBER)))) , (parameter (parameter_name (identifier (id_expression (regular_id v_date)))) IN (type_spec (datatype (native_datatype_element DATE)))) , (parameter (parameter_name (identifier (id_expression (regular_id v_log_descr)))) IN (type_spec (datatype (native_datatype_element VARCHAR2)))) , (parameter (parameter_name (identifier (id_expression (regular_id v_activity_code)))) IN (type_spec (datatype (native_datatype_element VARCHAR2)))) , (parameter (parameter_name (identifier (id_expression (regular_id v_action_code)))) IN (type_spec (datatype (native_datatype_element VARCHAR2)))) , (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (datatype (native_datatype_element VARCHAR2)))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id iv_detail_level))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_detail_level)))))))))))))) ;))) (body BEGIN (seq_of_statements (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id iv_detail_level))))))))))) IS NULL))) THEN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id iv_detail_level)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) ;) END IF)) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c log))))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id detail_level)))) , (column_name (identifier (id_expression (regular_id log_date)))) , (column_name (identifier (id_expression (regular_id log_descr)))) , (column_name (identifier (id_expression (regular_id activity_code)))) , (column_name (identifier (id_expression (regular_id result_code)))) , (column_name (identifier (id_expression (regular_id system_id))))) ))) (values_clause VALUES ( (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id iv_detail_level))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_log_descr))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_activity_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_action_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id)))))))))))))) ))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\add_log_item.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id ADD_LOG_ITEM)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_detail_level ) ) ) ) IN ( type_spec ( datatype ( native_datatype_element NUMBER ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_date ) ) ) ) IN ( type_spec ( datatype ( native_datatype_element DATE ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_log_descr ) ) ) ) IN ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_activity_code ) ) ) ) IN ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_action_code ) ) ) ) IN ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id iv_detail_level ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_detail_level ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id iv_detail_level ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) THEN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id iv_detail_level ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END IF ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c log ) ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id detail_level ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id log_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id log_descr ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id activity_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id result_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ( values_clause VALUES ( ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id iv_detail_level ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_log_descr ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_activity_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_action_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
D:\projects\plsqlcode\add_till_reduction_date.sql
(sql_script (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier (id_expression (regular_id ADD_TILL_REDUCTION_DATE)))) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_procname))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 50) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_nestlevel))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 5) )))) ;))) (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_procname)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_nestlevel)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utl_call_stack)) . (id_expression (regular_id dynamic_depth)))))))) - (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id DBMS_OUTPUT))) . (id_expression (regular_id PUT_LINE))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'INFO,')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_nestlevel))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ',<start>'))))))))))))) )))) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement insert (single_table_insert (insert_into_clause into (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_cp1)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id ROW_)))) , (column_name (identifier (id_expression (regular_id FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id REDUCTION_DATE)))) , (column_name (identifier (id_expression (regular_id AMOUNT_TYPE)))) , (column_name (identifier (id_expression (regular_id NETTING_TYPE)))) , (column_name (identifier (id_expression (regular_id AMOUNT)))) , (column_name (identifier (id_expression (regular_id REPORTING_DATE)))) , (column_name (identifier (id_expression (regular_id SYSTEM_ID))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rownum)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reduction_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id netting_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id system_id)))))))))))))))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id facility_run_off_dsa))))))))))))) (order_by_clause order by (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id)))))))))))))) , (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount_type)))))))))))))) , (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id netting_type)))))))))))))) , (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reduction_date))))))))))))))))))))) ;) exception (exception_handler when (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (raise_statement raise)) ;)) end)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'facility_run_off_dsa')))))))))))) )))) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement insert (single_table_insert (insert_into_clause into (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id facility_run_off_dsa)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id AMOUNT_TYPE)))) , (column_name (identifier (id_expression (regular_id NETTING_TYPE)))) , (column_name (identifier (id_expression (regular_id REDUCTION_DATE)))) , (column_name (identifier (id_expression (regular_id TILL_REDUCTION_DATE)))) , (column_name (identifier (id_expression (regular_id AMOUNT)))) , (column_name (identifier (id_expression (regular_id REPORTING_DATE)))) , (column_name (identifier (id_expression (regular_id SYSTEM_ID))))) ))) (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id netting_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reduction_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reduction_date)))))))))))))))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_cp1)))))))))) (where_clause where (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id facility_id))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id amount_type)))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id netting_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id netting_type)))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id row_)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id row_)))))))) + (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))))))) )))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '31-12-2200'))))))))))) ))))))))))))) (column_alias as (identifier (id_expression (regular_id till_reduction_date))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function cast ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount)))))))) as (type_spec (datatype (native_datatype_element number) (precision_part ( (numeric 22) , (numeric 2) )))) ))))))))))))) (column_alias as (identifier (id_expression (regular_id amount))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id system_id)))))))))))))))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_cp1)))))) (table_alias (identifier (id_expression (regular_id a))))))))))) (order_by_clause order by (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id)))))))))))))) , (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount_type)))))))))))))) , (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id netting_type)))))))))))))) , (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reduction_date))))))))))))))))))))) ;) exception (exception_handler when (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (raise_statement raise)) ;)) end)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'end')))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id DBMS_OUTPUT))) . (id_expression (regular_id PUT_LINE))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'INFO,')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_nestlevel))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ',<end>'))))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\add_till_reduction_date.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id ADD_TILL_REDUCTION_DATE)))))) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_procname ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 50 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_nestlevel ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 5 ) ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_nestlevel ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utl_call_stack ) ) . ( id_expression ( regular_id dynamic_depth ) ) ) ) ) ) ) ) - ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id DBMS_OUTPUT ) ) ) . ( id_expression ( regular_id PUT_LINE ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'INFO,' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_nestlevel ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ',<start>' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement insert ( single_table_insert ( insert_into_clause into ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_cp1 ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id ROW_ ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id REDUCTION_DATE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id AMOUNT_TYPE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id NETTING_TYPE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id AMOUNT ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id REPORTING_DATE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id SYSTEM_ID ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rownum ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reduction_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id facility_run_off_dsa ) ) ) ) ) ) ) ) ) ) ) ) ) ( order_by_clause order by ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reduction_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler when ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( raise_statement raise ) ) ; ) ) end ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'facility_run_off_dsa' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement insert ( single_table_insert ( insert_into_clause into ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id facility_run_off_dsa ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id AMOUNT_TYPE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id NETTING_TYPE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id REDUCTION_DATE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id TILL_REDUCTION_DATE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id AMOUNT ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id REPORTING_DATE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id SYSTEM_ID ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reduction_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reduction_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_cp1 ) ) ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id row_ ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id row_ ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '31-12-2200' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id till_reduction_date ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function cast ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount ) ) ) ) ) ) ) ) as ( type_spec ( datatype ( native_datatype_element number ) ( precision_part ( ( numeric 22 ) , ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id amount ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_cp1 ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ) ) ) ) ) ) ( order_by_clause order by ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reduction_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler when ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( raise_statement raise ) ) ; ) ) end ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'end' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id DBMS_OUTPUT ) ) ) . ( id_expression ( regular_id PUT_LINE ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'INFO,' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_nestlevel ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ',<end>' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
D:\projects\plsqlcode\agr_ifrs_ccy.sql
(sql_script (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier (id_expression (regular_id AGR_IFRS_CCY)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id SYSTEM_ID))))) , (parameter (parameter_name (identifier (id_expression (regular_id v_reporting_date)))) IN (type_spec (datatype (native_datatype_element DATE)))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_sys_error))) (type_spec (datatype (native_datatype_element NUMBER))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_starters_package_version))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 10) CHAR )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_error))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_exception_type))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id EXCEPTION_TYPE)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_activity_code))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id ACTIVITY_CODE)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_solution_code))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id SOLUTION_CODE)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_is_active))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id (non_reserved_keywords_pre12c INDICATOR))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_exception_category))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id EXCEPTION_CATEGORY)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_exception_code))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id EXCEPTION_CODE)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_perl_exception_ind))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) CHAR )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_descr))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) CHAR )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_default_currency))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 10) CHAR )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_cursor))) (type_spec (type_name (id_expression (regular_id SYS_REFCURSOR)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_temp))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 1) , (numeric 0) )))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_proc_name))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id procedure_name)))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit)))))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_debug_msg))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id debug_msg)))) ;))) (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_perl_exception_ind)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'EXC'))))))))))))) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vortex_reference)))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_default_currency)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_defaulting)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id defaulting_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'currency'))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id TRUNCATE_TABLE))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_temp_agg_ccy')))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_default_currency))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_add_on_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'NTADNCCYRDF'))))))))))))) (column_alias (identifier (id_expression (regular_id exception_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_add_on_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_add_on))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_add_on_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_add_on_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_add_on_ccy))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_add_on_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_add_on_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_add_on_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_add_on))))))))))) IS NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_default_currency))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_mark_to_market_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'NTMTMCCYRDF'))))))))))))) (column_alias (identifier (id_expression (regular_id exception_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_mark_to_market_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_mark_to_market))))))))))) IS NOT NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_mark_to_market_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_mark_to_market_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_mark_to_market_ccy))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_mark_to_market_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_mark_to_market_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_mark_to_market_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_mark_to_market))))))))))) IS NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_default_currency))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_collateral_internal_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'NCINTCCYRDF'))))))))))))) (column_alias (identifier (id_expression (regular_id exception_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_internal_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_internal))))))))))) IS NOT NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_internal_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_collateral_internal_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_internal_ccy))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_internal_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_collateral_internal_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_internal_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_internal))))))))))) IS NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_default_currency))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_collateral_regulatory_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'NCREGCCYRDF'))))))))))))) (column_alias (identifier (id_expression (regular_id exception_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_regulatory_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_regulatory))))))))))) IS NOT NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_regulatory_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_collateral_regulatory_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_regulatory_ccy))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_regulatory_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_collateral_regulatory_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_regulatory_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id net_collateral_regulatory))))))))))) IS NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_default_currency))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'margin_threshold_cp_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'MTRCPCCYRDF'))))))))))))) (column_alias (identifier (id_expression (regular_id exception_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_cp_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_cp))))))))))) IS NOT NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_cp_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'margin_threshold_cp_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_cp_ccy))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_cp_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'margin_threshold_cp_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_cp_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_cp))))))))))) IS NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_default_currency))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'margin_threshold_party_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'MTRPTCCYRDF'))))))))))))) (column_alias (identifier (id_expression (regular_id exception_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_party_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_party))))))))))) IS NOT NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_party_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'margin_threshold_party_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_party_ccy))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_party_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'margin_threshold_party_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_party_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id margin_threshold_party))))))))))) IS NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_default_currency))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'mta_counterparty_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'MTCPCCYRDF'))))))))))))) (column_alias (identifier (id_expression (regular_id exception_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_counterparty_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_counterparty))))))))))) IS NOT NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_counterparty_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'mta_counterparty_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_counterparty_ccy))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_counterparty_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'mta_counterparty_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_counterparty_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_counterparty))))))))))) IS NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_default_currency))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'mta_ing_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'MTINGCCYRDF'))))))))))))) (column_alias (identifier (id_expression (regular_id exception_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_ing_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_ing))))))))))) IS NOT NULL))))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_ing_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'mta_ing_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_ing_ccy))))))))))) IS NOT NULL)))))) (subquery_operation_part UNION ALL (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_ing_ccy))))))))))))))) (column_alias (identifier (id_expression (regular_id ccy_value))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias (identifier (id_expression (regular_id default_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'mta_ing_ccy'))))))))))))) (column_alias (identifier (id_expression (regular_id field_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_agreement)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_ing_ccy))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mta_ing))))))))))) IS NULL)))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' value for v_default_fb_measure ')))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_exception_code')))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_exception_code))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id exception_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function MAX ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id exception_code))))))))))))) ))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_exception_code)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_exception_code))))))))))))))))) ; (statement (loop_statement WHILE (condition (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))))) IS NOT NULL))) ))))))))))) LOOP (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_exception_category)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'AGR'))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_solution_code)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'DEFAULTED'))))))))))))) ; (statement (body begin (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id get_exception_info))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_type)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_activity_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_solution_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_is_active)))))))))))))) )))) ;) exception (exception_handler when (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) end)) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_is_active)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) THEN (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_descr)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'create exceptions for code: ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ', exception category: '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_descr)))))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id exception)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id reporting_date)))) , (column_name (identifier (id_expression (regular_id exception_category)))) , (column_name (identifier (id_expression (regular_id exception_type)))) , (column_name (identifier (id_expression (regular_id exception_code)))) , (column_name (identifier (id_expression (regular_id activity_code)))) , (column_name (identifier (id_expression (regular_id solution_code)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id facility_id)))) , (column_name (identifier (id_expression (regular_id cover_id)))) , (column_name (identifier (id_expression (regular_id outstanding_id)))) , (column_name (identifier (id_expression (regular_id local_value)))) , (column_name (identifier (id_expression (regular_id icrm_value)))) , (column_name (identifier (id_expression (regular_id additional_information)))) , (column_name (identifier (id_expression (regular_id row_id)))) , (column_name (identifier (id_expression (regular_id INCOME_ID))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_activity_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_solution_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id field_name)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' defaulted to '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant null))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id default_indicator)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id exception_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))))))))))))) ))))))))) ;) END)) ;) END IF)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_exception_code)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id exception_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function MAX ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id exception_code))))))))))))) ))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_exception_code)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_exception_code))))))))))))))))) ;) END)) ;) END LOOP)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' value for v_default_fb_measure ')))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'pp_agg_ifrs_ccy')))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_agg_ifrs_ccy))))))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id nmtm) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_agreement_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id nmtm)) . (id_expression (regular_id ccy_value))))))))))))))) (column_alias (identifier (id_expression (regular_id net_mark_to_market_ccy))))) , (selected_element (select_list_elements (regular_id nado) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value))))))))))))))) (column_alias (identifier (id_expression (regular_id net_add_on_ccy))))) , (selected_element (select_list_elements (regular_id ncoli) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value))))))))))))))) (column_alias (identifier (id_expression (regular_id net_collateral_internal_ccy))))) , (selected_element (select_list_elements (regular_id ncolr) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value))))))))))))))) (column_alias (identifier (id_expression (regular_id net_collateral_regulatory_ccy))))) , (selected_element (select_list_elements (regular_id mtcp) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value))))))))))))))) (column_alias (identifier (id_expression (regular_id margin_threshold_cp_ccy))))) , (selected_element (select_list_elements (regular_id mtpt) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value))))))))))))))) (column_alias (identifier (id_expression (regular_id margin_threshold_party_ccy))))) , (selected_element (select_list_elements (regular_id mtacp) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value))))))))))))))) (column_alias (identifier (id_expression (regular_id mta_counterparty_ccy))))) , (selected_element (select_list_elements (regular_id mting) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ccy_value))))))))))))))) (column_alias (identifier (id_expression (regular_id mta_ing_ccy))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))) (table_alias (identifier (id_expression (regular_id nmtm))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))) (table_alias (identifier (id_expression (regular_id nado))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id nmtm)) . (id_expression (regular_id raw_agreement_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id nado)) . (id_expression (regular_id raw_agreement_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id nmtm)) . (id_expression (regular_id field_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_mark_to_market_ccy')))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id nado)) . (id_expression (regular_id field_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_add_on_ccy')))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))) (table_alias (identifier (id_expression (regular_id ncoli))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id nado)) . (id_expression (regular_id raw_agreement_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ncoli)) . (id_expression (regular_id raw_agreement_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ncoli)) . (id_expression (regular_id field_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_collateral_internal_ccy')))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))) (table_alias (identifier (id_expression (regular_id ncolr))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ncoli)) . (id_expression (regular_id raw_agreement_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ncolr)) . (id_expression (regular_id raw_agreement_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ncolr)) . (id_expression (regular_id field_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'net_collateral_regulatory_ccy')))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))) (table_alias (identifier (id_expression (regular_id mtcp))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ncolr)) . (id_expression (regular_id raw_agreement_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtcp)) . (id_expression (regular_id raw_agreement_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtcp)) . (id_expression (regular_id field_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'margin_threshold_cp_ccy')))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))) (table_alias (identifier (id_expression (regular_id mtpt))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtcp)) . (id_expression (regular_id raw_agreement_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtpt)) . (id_expression (regular_id raw_agreement_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtpt)) . (id_expression (regular_id field_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'margin_threshold_party_ccy')))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))) (table_alias (identifier (id_expression (regular_id mtacp))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtpt)) . (id_expression (regular_id raw_agreement_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtacp)) . (id_expression (regular_id raw_agreement_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtacp)) . (id_expression (regular_id field_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'mta_counterparty_ccy')))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_agg_ccy)))))) (table_alias (identifier (id_expression (regular_id mting))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mtacp)) . (id_expression (regular_id raw_agreement_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mting)) . (id_expression (regular_id raw_agreement_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mting)) . (id_expression (regular_id field_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'mta_ing_ccy')))))))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'end')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\agr_ifrs_ccy.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id AGR_IFRS_CCY)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id SYSTEM_ID ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_reporting_date ) ) ) ) IN ( type_spec ( datatype ( native_datatype_element DATE ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_sys_error ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_starters_package_version ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 10 ) CHAR ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_error ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_exception_type ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id EXCEPTION_TYPE ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_activity_code ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id ACTIVITY_CODE ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_solution_code ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id SOLUTION_CODE ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_is_active ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c INDICATOR ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_exception_category ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id EXCEPTION_CATEGORY ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_exception_code ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id EXCEPTION_CODE ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_perl_exception_ind ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) CHAR ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_descr ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) CHAR ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_default_currency ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 10 ) CHAR ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_cursor ) ) ) ( type_spec ( type_name ( id_expression ( regular_id SYS_REFCURSOR ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_temp ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 1 ) , ( numeric 0 ) ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_proc_name ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id procedure_name ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_debug_msg ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id debug_msg ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_perl_exception_ind ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'EXC' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vortex_reference ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_default_currency ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_defaulting ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id defaulting_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'currency' ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id TRUNCATE_TABLE ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_temp_agg_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_default_currency ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_add_on_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'NTADNCCYRDF' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exception_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_add_on_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_add_on ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_add_on_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_add_on_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_add_on_ccy ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_add_on_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_add_on_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_add_on_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_add_on ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_default_currency ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_mark_to_market_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'NTMTMCCYRDF' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exception_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_mark_to_market_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_mark_to_market ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_mark_to_market_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_mark_to_market_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_mark_to_market_ccy ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_mark_to_market_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_mark_to_market_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_mark_to_market_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_mark_to_market ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_default_currency ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_collateral_internal_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'NCINTCCYRDF' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exception_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_internal_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_internal ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_internal_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_collateral_internal_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_internal_ccy ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_internal_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_collateral_internal_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_internal_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_internal ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_default_currency ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_collateral_regulatory_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'NCREGCCYRDF' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exception_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_regulatory_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_regulatory ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_regulatory_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_collateral_regulatory_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_regulatory_ccy ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_regulatory_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_collateral_regulatory_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_regulatory_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id net_collateral_regulatory ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_default_currency ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'margin_threshold_cp_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'MTRCPCCYRDF' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exception_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_cp_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_cp ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_cp_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'margin_threshold_cp_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_cp_ccy ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_cp_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'margin_threshold_cp_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_cp_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_cp ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_default_currency ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'margin_threshold_party_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'MTRPTCCYRDF' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exception_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_party_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_party ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_party_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'margin_threshold_party_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_party_ccy ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_party_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'margin_threshold_party_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_party_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id margin_threshold_party ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_default_currency ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'mta_counterparty_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'MTCPCCYRDF' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exception_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_counterparty_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_counterparty ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_counterparty_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'mta_counterparty_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_counterparty_ccy ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_counterparty_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'mta_counterparty_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_counterparty_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_counterparty ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_default_currency ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'mta_ing_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'MTINGCCYRDF' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exception_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_ing_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_ing ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_ing_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'mta_ing_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_ing_ccy ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ( subquery_operation_part UNION ALL ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_ing_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ccy_value ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id default_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'mta_ing_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id field_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_agreement ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_ing_ccy ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mta_ing ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' value for v_default_fb_measure ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_exception_code' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_exception_code ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function MAX ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_exception_code ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( loop_statement WHILE ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) LOOP ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'AGR' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'DEFAULTED' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id get_exception_info ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_activity_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_is_active ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler when ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) end ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_is_active ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_descr ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'create exceptions for code: ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ', exception category: ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_descr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id exception ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id reporting_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_category ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_type ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id activity_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id solution_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id cover_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id outstanding_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_value ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id icrm_value ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id additional_information ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id row_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id INCOME_ID ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_activity_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' defaulted to ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant null ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id default_indicator ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id exception_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) END IF ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_exception_code ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id exception_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function MAX ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_exception_code ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) END LOOP ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' value for v_default_fb_measure ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'pp_agg_ifrs_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_agg_ifrs_ccy ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id nmtm ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id nmtm ) ) . ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id net_mark_to_market_ccy ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id nado ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id net_add_on_ccy ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id ncoli ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id net_collateral_internal_ccy ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id ncolr ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id net_collateral_regulatory_ccy ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id mtcp ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id margin_threshold_cp_ccy ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id mtpt ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id margin_threshold_party_ccy ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id mtacp ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id mta_counterparty_ccy ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id mting ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ccy_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id mta_ing_ccy ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id nmtm ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id nado ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id nmtm ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id nado ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id nmtm ) ) . ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_mark_to_market_ccy' ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id nado ) ) . ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_add_on_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ncoli ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id nado ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ncoli ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ncoli ) ) . ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_collateral_internal_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ncolr ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ncoli ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ncolr ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ncolr ) ) . ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'net_collateral_regulatory_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id mtcp ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ncolr ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtcp ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtcp ) ) . ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'margin_threshold_cp_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id mtpt ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtcp ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtpt ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtpt ) ) . ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'margin_threshold_party_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id mtacp ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtpt ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtacp ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtacp ) ) . ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'mta_counterparty_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_agg_ccy ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id mting ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mtacp ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mting ) ) . ( id_expression ( regular_id raw_agreement_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mting ) ) . ( id_expression ( regular_id field_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'mta_ing_ccy' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'end' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
D:\projects\plsqlcode\asset_duplicates.sql
(sql_script (unit_statement (create_procedure_body CREATE OR REPLACE PROCEDURE (procedure_name (identifier (id_expression (regular_id ASSET_DUPLICATES)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id SYSTEM_ID))))) , (parameter (parameter_name (identifier (id_expression (regular_id v_reporting_date)))) IN (type_spec (datatype (native_datatype_element DATE)))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_procid))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_error))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_rows))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_exception_type))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id EXCEPTION_TYPE)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_activity_code))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id ACTIVITY_CODE)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_solution_code))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id SOLUTION_CODE)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_is_active))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id (non_reserved_keywords_pre12c INDICATOR))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_exception_category))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id EXCEPTION_CATEGORY)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_exception_code))) (type_spec (type_name (id_expression (regular_id PKG_SUBTYPE)) . (id_expression (regular_id EXCEPTION_CODE)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_perl_exception_ind))) (type_spec (datatype (native_datatype_element CHAR) (precision_part ( (numeric 3) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_descr))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_cursor))) (type_spec (type_name (id_expression (regular_id SYS_REFCURSOR)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_procname))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id procname)))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit)))))))))))))) ;))) (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_perl_exception_ind)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'EXC'))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_assetdup_1')))))))))))) )))) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assetdup_1))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id asset_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_value_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function MAX ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_value_date))))))))))))) )))))))))))))) (column_alias (identifier (id_expression (regular_id cover_value_date))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_cover_value)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id asset_id))))))))))) IS NOT NULL))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id asset_id)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_value_type)))))))))))))) (having_clause HAVING (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function COUNT ( * ))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))))))) ))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_assetdup_2')))))))))))) )))) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assetdup_2))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id rcov) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id asset_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (over_clause_keyword MIN) (function_argument_analytic ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_amount)))))))))))))) )))))))))))))) (column_alias (identifier (id_expression (regular_id cover_amount))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_cover_value)))))) (table_alias (identifier (id_expression (regular_id rcov))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assetdup_1)))))) (table_alias (identifier (id_expression (regular_id tmp))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id asset_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id asset_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id cover_value_type)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function NVL ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function to_date ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '9999-01-01'))))))))))) , (quoted_string 'YYYY-MM-DD') ))))))))))) )))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function NVL ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id cover_value_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function to_date ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '9999-01-01'))))))))))) , (quoted_string 'YYYY-MM-DD') ))))))))))) ))))))))))))))))))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id asset_id)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_type)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_date)))))))))))))))))) ))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_assettokeep_1')))))))))))) )))) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assettokeep_1))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id rcov) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_cover_value_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id asset_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_amount))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_type)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_cover_value)))))) (table_alias (identifier (id_expression (regular_id rcov))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assetdup_2)))))) (table_alias (identifier (id_expression (regular_id tmp))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id asset_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id asset_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id cover_value_type)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function NVL ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function to_date ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '9999-01-01'))))))))))) , (quoted_string 'YYYY-MM-DD') ))))))))))) )))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function NVL ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id cover_value_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function to_date ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '9999-01-01'))))))))))) , (quoted_string 'YYYY-MM-DD') ))))))))))) )))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function NVL ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_amount))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 99999)))))))))))) )))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function NVL ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id cover_amount))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 99999)))))))))))) )))))))))))))))))))))) ))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_assettokeep')))))))))))) )))) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assettokeep))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (over_clause_keyword MIN) (function_argument_analytic ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_cover_value_id)))))))))))))) )))))))))))))) (column_alias (identifier (id_expression (regular_id raw_cover_value_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id asset_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_value_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_amount))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_value_type)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assettokeep_1)))))))))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id asset_id)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_value_date)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_amount)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cover_value_type)))))))))))))))))) ))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_assettodelete')))))))))))) )))) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assettodelete))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id rcov) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_cover_value_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id asset_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_cover_value)))))) (table_alias (identifier (id_expression (regular_id rcov))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assettokeep)))))) (table_alias (identifier (id_expression (regular_id tmp))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id asset_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id asset_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id cover_value_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id cover_value_type)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcov)) . (id_expression (regular_id raw_cover_value_id)))))))))) (relational_operator !=) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tmp)) . (id_expression (regular_id raw_cover_value_id)))))))))))))))))))))))) ))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_exception_code)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'ASSETDUPL'))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_exception_category)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'COL'))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_solution_code)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'DELETED'))))))))))))) ; (statement (body begin (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id get_exception_info))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_type)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_activity_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_solution_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_is_active)))))))))))))) )))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_is_active)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) THEN (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_descr)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'create exceptions for code: ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ', exception category: '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_descr)))))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id exception)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id reporting_date)))) , (column_name (identifier (id_expression (regular_id exception_category)))) , (column_name (identifier (id_expression (regular_id exception_type)))) , (column_name (identifier (id_expression (regular_id exception_code)))) , (column_name (identifier (id_expression (regular_id activity_code)))) , (column_name (identifier (id_expression (regular_id solution_code)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id facility_id)))) , (column_name (identifier (id_expression (regular_id cover_id)))) , (column_name (identifier (id_expression (regular_id outstanding_id)))) , (column_name (identifier (id_expression (regular_id local_value)))) , (column_name (identifier (id_expression (regular_id icrm_value)))) , (column_name (identifier (id_expression (regular_id additional_information)))) , (column_name (identifier (id_expression (regular_id row_id))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_activity_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_solution_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id dup)) . (id_expression (regular_id asset_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id dup)) . (id_expression (regular_id asset_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Duplicate asset record.'))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id dup)) . (id_expression (regular_id raw_cover_value_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assettodelete)))))) (table_alias (identifier (id_expression (regular_id dup))))))))))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ;) END IF)) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_cover_value)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_cover_value_id)))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_cover_value_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_assettodelete))))))))))))) )))))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_invalidasset')))))))))))) )))) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_invalidasset))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id cva) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_cover_value_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cva)) . (id_expression (regular_id asset_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_cover_value)))))) (table_alias (identifier (id_expression (regular_id cva)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cva)) . (id_expression (regular_id asset_id))))))))))) IS NOT NULL) AND (logical_expression NOT (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT * (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_cover)))))) (table_alias (identifier (id_expression (regular_id rc)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id asset_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cva)) . (id_expression (regular_id asset_id)))))))))))))))))) )))))))))))))))) ))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_exception_code)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'ASSETIDREF'))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_exception_category)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'COL'))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_solution_code)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'DELETED'))))))))))))) ; (statement (body begin (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id get_exception_info))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_type)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_activity_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_solution_code)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_is_active)))))))))))))) )))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_is_active)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y'))))))))))))) THEN (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_descr)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'create exceptions for code: ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ', exception category: '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_descr)))))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id exception)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id reporting_date)))) , (column_name (identifier (id_expression (regular_id exception_category)))) , (column_name (identifier (id_expression (regular_id exception_type)))) , (column_name (identifier (id_expression (regular_id exception_code)))) , (column_name (identifier (id_expression (regular_id activity_code)))) , (column_name (identifier (id_expression (regular_id solution_code)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id facility_id)))) , (column_name (identifier (id_expression (regular_id cover_id)))) , (column_name (identifier (id_expression (regular_id outstanding_id)))) , (column_name (identifier (id_expression (regular_id local_value)))) , (column_name (identifier (id_expression (regular_id icrm_value)))) , (column_name (identifier (id_expression (regular_id additional_information)))) , (column_name (identifier (id_expression (regular_id row_id))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_category))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_exception_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_activity_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_solution_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id dup)) . (id_expression (regular_id asset_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id dup)) . (id_expression (regular_id asset_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Invalid cover id'))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id dup)) . (id_expression (regular_id raw_cover_value_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_invalidasset)))))) (table_alias (identifier (id_expression (regular_id dup))))))))))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ;) END IF)) ; (statement (body begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_cover_value)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_cover_value_id)))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_cover_value_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_invalidasset))))))))))))) )))))))))))) ;) exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) End)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'end')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) <EOF>)
D:\projects\plsqlcode\asset_duplicates.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body CREATE OR REPLACE PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id ASSET_DUPLICATES)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id SYSTEM_ID ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_reporting_date ) ) ) ) IN ( type_spec ( datatype ( native_datatype_element DATE ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_procid ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_error ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_rows ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_exception_type ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id EXCEPTION_TYPE ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_activity_code ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id ACTIVITY_CODE ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_solution_code ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id SOLUTION_CODE ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_is_active ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c INDICATOR ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_exception_category ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id EXCEPTION_CATEGORY ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_exception_code ) ) ) ( type_spec ( type_name ( id_expression ( regular_id PKG_SUBTYPE ) ) . ( id_expression ( regular_id EXCEPTION_CODE ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_perl_exception_ind ) ) ) ( type_spec ( datatype ( native_datatype_element CHAR ) ( precision_part ( ( numeric 3 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_descr ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_cursor ) ) ) ( type_spec ( type_name ( id_expression ( regular_id SYS_REFCURSOR ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_procname ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id procname ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_perl_exception_ind ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'EXC' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_assetdup_1' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assetdup_1 ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function MAX ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id cover_value_date ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_cover_value ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( having_clause HAVING ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function COUNT ( * ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_assetdup_2' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assetdup_2 ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id rcov ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( over_clause_keyword MIN ) ( function_argument_analytic ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_amount ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id cover_amount ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_cover_value ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rcov ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assetdup_1 ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id tmp ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function NVL ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function to_date ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '9999-01-01' ) ) ) ) ) ) ) ) ) ) ) , ( quoted_string 'YYYY-MM-DD' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function NVL ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function to_date ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '9999-01-01' ) ) ) ) ) ) ) ) ) ) ) , ( quoted_string 'YYYY-MM-DD' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_assettokeep_1' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assettokeep_1 ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id rcov ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_amount ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_cover_value ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rcov ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assetdup_2 ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id tmp ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function NVL ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function to_date ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '9999-01-01' ) ) ) ) ) ) ) ) ) ) ) , ( quoted_string 'YYYY-MM-DD' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function NVL ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function to_date ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '9999-01-01' ) ) ) ) ) ) ) ) ) ) ) , ( quoted_string 'YYYY-MM-DD' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function NVL ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_amount ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 99999 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function NVL ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id cover_amount ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 99999 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_assettokeep' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assettokeep ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( over_clause_keyword MIN ) ( function_argument_analytic ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_amount ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assettokeep_1 ) ) ) ) ) ) ) ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_value_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_amount ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_assettodelete' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assettodelete ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id rcov ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_cover_value ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rcov ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assettokeep ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id tmp ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id cover_value_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcov ) ) . ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ( relational_operator != ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tmp ) ) . ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'ASSETDUPL' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'COL' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'DELETED' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id get_exception_info ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_activity_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_is_active ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_is_active ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_descr ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'create exceptions for code: ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ', exception category: ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_descr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id exception ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id reporting_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_category ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_type ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id activity_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id solution_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id cover_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id outstanding_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_value ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id icrm_value ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id additional_information ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_activity_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id dup ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id dup ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Duplicate asset record.' ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id dup ) ) . ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assettodelete ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id dup ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ) END IF ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_cover_value ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_assettodelete ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_invalidasset' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_invalidasset ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id cva ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cva ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_cover_value ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id cva ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cva ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression NOT ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT * ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_cover ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cva ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'ASSETIDREF' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'COL' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'DELETED' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id get_exception_info ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_activity_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_is_active ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_is_active ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_descr ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'create exceptions for code: ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ', exception category: ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_descr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id exception ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id reporting_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_category ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_type ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exception_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id activity_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id solution_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id cover_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id outstanding_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_value ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id icrm_value ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id additional_information ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_category ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_exception_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_activity_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_solution_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id dup ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id dup ) ) . ( id_expression ( regular_id asset_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Invalid cover id' ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id dup ) ) . ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_invalidasset ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id dup ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ) END IF ) ) ; ( statement ( body begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_cover_value ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_cover_value_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_invalidasset ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'end' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) < EOF > ))
D:\projects\plsqlcode\assign_id_ranges.sql
(sql_script (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier (id_expression (regular_id ASSIGN_ID_RANGES)))) ( (parameter (parameter_name (identifier (id_expression (regular_id p_id_type)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id idtype))))) , (parameter (parameter_name (identifier (id_expression (regular_id p_table_name)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id tablename))))) , (parameter (parameter_name (identifier (id_expression (regular_id p_key_column)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id key_column))))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_iden))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 2000) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_key))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 2000) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_where))) (type_spec (datatype (native_datatype_element CLOB))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_i))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_j))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_cnt))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_ind_id))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_ind_cnt))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_override))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_sql))) (type_spec (datatype (native_datatype_element CLOB))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_rows))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_left))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_cur))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_basetype))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 30) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_temp))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 1) , (numeric 0) )))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_t))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_colist))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 200) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_whr_clause))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 4000) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_id_type))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id idtype)))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c Upper))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id p_id_type)))))))))))))) )))))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id vtable_name))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id tablename)))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c Upper))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id p_table_name)))))))))))))) )))))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_key_column))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id key_column)))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c Upper))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id p_key_column)))))))))))))) )))))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id e_failed))) (type_spec (type_name (id_expression (regular_id EXCEPTION)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_msg))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 2000) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_schema_name))) (type_spec (datatype (native_datatype_element varchar2) (precision_part ( (numeric 32) )))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SYS_CONTEXT))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'USERENV')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'SESSION_SCHEMA')))))))))))) )))))))))))))) ;))) (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_iden)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_key)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-1:Checking input variables')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_temp)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id dual)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_instances)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c upper))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function trim ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id srv_name)))))))) )))))))))))) )))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c upper))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function trim ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id UTILITIES)) . (id_expression (regular_id SERVERNAME)))))))) )))))))))))) ))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c upper))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function trim ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id db_name)))))))) )))))))))))) )))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_schema_name))))))))))))))))))) )))))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_temp>>')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_temp))))))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id no_data_found)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_unknown_instance))))) ;)) (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (raise_statement raise)) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-2: After RAISE exception_util.err_unknown_instance')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_temp)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id dual)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_id_ranges)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id id_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_id_type))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id instance_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id instance_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_instances)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id srv_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id UTILITIES)) . (id_expression (regular_id SERVERNAME))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id db_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_schema_name))))))))))))))))))) )))))))))))))))) )))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id no_data_found)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_no_range))))) ;)) (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_temp)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-3: RAISE exception_util.err_no_range')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_temp)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id dual)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id user_tab_columns)))))) (table_alias (identifier (id_expression (regular_id o)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id table_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id column_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key_column))))))))))))))))))) )))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id no_data_found)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_no_object))))) ;)) (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (raise_statement raise)) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-4:  RAISE exception_util.err_no_object')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-0:Finding unique identifier.')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id column_name)))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_iden)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id user_tab_identity_cols)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id table_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name)))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id no_data_found)))) THEN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_iden)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id index_name)))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_key)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id user_indexes)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id uniqueness)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'UNIQUE'))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id table_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name))))))))))))))))))) (fetch_clause fetch first rows only))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id no_data_found)))) THEN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_key)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_iden - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_iden))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '   '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_key - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (if_statement IF (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_iden))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key))))))))))) IS NULL)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_no_ident))))) ;) END IF)) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_iden))))))))))) IS NOT NULL))) THEN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_key)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string ', CAST(')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_iden))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' AS number(18)) '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_iden))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ', ')))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_where)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'WHERE ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '.'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_iden))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' = t.'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_iden))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ')))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_t)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ;) (else_part ELSE (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_key)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_where)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_t)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Before LISTAGG')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (within_or_over_clause_keyword LISTAGG) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id column_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ',')))))))))))) )) (within_or_over_part WITHIN GROUP ( (order_by_clause ORDER BY (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id column_position))))))))))))))) )))))))))))))) (column_alias AS (identifier (id_expression (regular_id cols))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (within_or_over_clause_keyword LISTAGG) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id table_name)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '.'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id column_name))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' = t.'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id column_name))))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' AND ')))))))))))) )) (within_or_over_part WITHIN GROUP ( (order_by_clause ORDER BY (order_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id column_position))))))))))))))) )))))))))))))) (column_alias AS (identifier (id_expression (regular_id whr))))) (into_clause INTO (variable_name (id_expression (regular_id v_colist))) , (variable_name (id_expression (regular_id v_whr_clause)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id user_indexes)))))) (table_alias (identifier (id_expression (regular_id ui))))) (join_clause INNER JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id user_ind_columns)))))) (table_alias (identifier (id_expression (regular_id uic))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id table_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id uic)) . (id_expression (regular_id table_name))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id index_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id uic)) . (id_expression (regular_id index_name))))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id uniqueness)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'UNIQUE'))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id table_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id index_name)))))))) NOT IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id index_name)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id user_ind_columns)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id column_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key_column))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id table_name))))))))))))))))))) ))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWNUM))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id table_name)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ui)) . (id_expression (regular_id index_name)))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id no_data_found)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_no_unique))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'After LISTAGG'))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_colist - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_colist))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_whr_clause - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_whr_clause)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_key)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ', '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_colist)))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_where)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_where))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))) | | (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_t)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'WHERE ')))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'AND ')))))))))))) END)))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_whr_clause))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ')))))))))))))) ;) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_key)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ', ')))))))))))))) ;) END)) ;)) END IF)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Before EXECUTE IMMEDIATE')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rows)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_sql)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'SELECT COUNT(*) FROM ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name)))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_sql-->'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_sql)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body Begin (seq_of_statements (statement (sql_statement (execute_immediate EXECUTE IMMEDIATE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_sql))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_rows))))))) ;) Exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (raise_statement Raise (exception_name (identifier (id_expression (regular_id e_failed)))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Error EXECUTE IMMEDIATE')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ;)) End)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_id_type - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_id_type)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body Begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id r1) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id current_value))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r1)) . (id_expression (regular_id max_value)))))))) - (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r1)) . (id_expression (regular_id current_value))))))))))))))) ))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_cur))) , (variable_name (id_expression (regular_id v_left)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_id_ranges)))))) (table_alias (identifier (id_expression (regular_id r1)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r1)) . (id_expression (regular_id min_value)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function MAX ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r2)) . (id_expression (regular_id min_value))))))))))))) ))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_id_ranges)))))) (table_alias (identifier (id_expression (regular_id r2)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r2)) . (id_expression (regular_id instance_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r1)) . (id_expression (regular_id instance_code))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r2)) . (id_expression (regular_id id_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r1)) . (id_expression (regular_id id_type))))))))))))))))))) )))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r1)) . (id_expression (regular_id instance_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id i) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id instance_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_instances)))))) (table_alias (identifier (id_expression (regular_id i)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i)) . (id_expression (regular_id srv_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id UTILITIES)) . (id_expression (regular_id SERVERNAME))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i)) . (id_expression (regular_id db_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_schema_name))))))))))))))))))) ))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r1)) . (id_expression (regular_id id_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_id_type))))))))))))))))))))))) ;) Exception (exception_handler When (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (raise_statement Raise (exception_name (identifier (id_expression (regular_id e_failed)))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Error vleft '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ;)) End)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_cur - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_cur))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '   '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_left - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_left))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_rows - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rows)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_left)))))))))) (relational_operator <) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rows))))))))))))))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_not_enough_keys))))) ;) END IF)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Determine key_column base type')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'NUMBER')))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_scale))))))))))) IS NULL)) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' NUMBER(')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_precision))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ') '))))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' NUMBER(')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_precision))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ','))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_scale))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ') '))))))))))))) END))))))))))) (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'DATE')))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' DATE ')))))))))))) (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c instr))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_type)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CHAR')))))))))))) )))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_type))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_length))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ') '))))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id data_type))))))))))))))) END (label_name (id_expression (regular_id col_datatype)))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_basetype)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id user_tab_columns)))))) (table_alias (identifier (id_expression (regular_id utc)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utc)) . (id_expression (regular_id table_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utc)) . (id_expression (regular_id column_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key_column))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_basetype)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))))) ;)) END)) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_basetype))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_datatype))))) ;) END IF)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Assign new IDs')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'assign_key_tt')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement Raise (exception_name (identifier (id_expression (regular_id e_failed)))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' Failed to  DROP/TRUNCATE TABLE assign_key_tt: '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' v_key - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '    '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_cur - '))))))) | | (concatenation (model_expression (unary_expression (standard_function (string_function TO_CHAR ( (table_element (id_expression (regular_id v_cur))) ))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_where - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_where)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_sql)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'insert into assign_key_tt SELECT rownum id12345678id12345678')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CAST(0 AS number(18)) key1234567key1234567'))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' FROM '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name)))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_sql 1 - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_sql)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (sql_statement (execute_immediate EXECUTE IMMEDIATE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_sql)))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_sql)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant null)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_sql)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'UPDATE assign_key_tt ')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'SET    key1234567key1234567 = id12345678id12345678 - 1 +'))))))) | | (concatenation (model_expression (unary_expression (standard_function (string_function TO_CHAR ( (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_cur))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) ))) )))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_sql 2 - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_sql)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (sql_statement (execute_immediate EXECUTE IMMEDIATE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_sql)))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_sql)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant null)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_sql)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'UPDATE ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vtable_name))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'SET '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_key_column))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' =(Select CAST(key1234567key1234567 AS '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_basetype))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ') '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'FROM   assign_key_tt t'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_where))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ')')))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'v_sql 3 - '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_sql)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (sql_statement (execute_immediate EXECUTE IMMEDIATE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_sql)))))))))))))))) ; (statement (body Begin (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (update_statement UPDATE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_id_ranges)))))) (update_set_clause SET (column_based_update_set_clause (column_name (identifier (id_expression (regular_id current_value)))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_cur)))))))) + (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rows)))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id proxy_id_ranges)) . (id_expression (regular_id min_value)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function MAX ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r2)) . (id_expression (regular_id min_value))))))))))))) ))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_id_ranges)))))) (table_alias (identifier (id_expression (regular_id r2)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r2)) . (id_expression (regular_id instance_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id proxy_id_ranges)) . (id_expression (regular_id instance_code))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r2)) . (id_expression (regular_id id_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id proxy_id_ranges)) . (id_expression (regular_id id_type))))))))))))))))))) )))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id proxy_id_ranges)) . (id_expression (regular_id instance_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id i) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id instance_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id proxy_instances)))))) (table_alias (identifier (id_expression (regular_id i)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i)) . (id_expression (regular_id srv_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id UTILITIES)) . (id_expression (regular_id SERVERNAME))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i)) . (id_expression (regular_id db_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_schema_name))))))))))))))))))) ))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id proxy_id_ranges)) . (id_expression (regular_id id_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_id_type)))))))))))))))))))) ;) Exception (exception_handler when (exception_name (identifier (id_expression (regular_id others)))) then (seq_of_statements (statement (raise_statement Raise (exception_name (identifier (id_expression (regular_id e_failed)))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_LINE)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id PLSQL_UNIT))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Update Failed: '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ;)) End)) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id e_failed)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id geterror)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) )))))))))))))) )))) ;)) (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (sql_statement (transaction_control_statements (rollback_statement ROLLBACK)))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id geterror)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) )))))))))))))) )))) ;)) END (label_name (id_expression (regular_id assign_id_ranges)))) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\assign_id_ranges.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id ASSIGN_ID_RANGES)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id p_id_type ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id idtype ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id p_table_name ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id tablename ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id p_key_column ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id key_column ) ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_iden ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 2000 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_key ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 2000 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_where ) ) ) ( type_spec ( datatype ( native_datatype_element CLOB ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_i ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_j ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_cnt ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_ind_id ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_ind_cnt ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_override ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_sql ) ) ) ( type_spec ( datatype ( native_datatype_element CLOB ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_rows ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_left ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_cur ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_basetype ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 30 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_temp ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 1 ) , ( numeric 0 ) ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_t ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_colist ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 200 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_whr_clause ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 4000 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_id_type ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id idtype ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c Upper ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id p_id_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id vtable_name ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id tablename ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c Upper ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id p_table_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_key_column ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id key_column ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c Upper ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id p_key_column ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id e_failed ) ) ) ( type_spec ( type_name ( id_expression ( regular_id EXCEPTION ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_msg ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 2000 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_schema_name ) ) ) ( type_spec ( datatype ( native_datatype_element varchar2 ) ( precision_part ( ( numeric 32 ) ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SYS_CONTEXT ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'USERENV' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'SESSION_SCHEMA' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-1:Checking input variables' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id dual ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_instances ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c upper ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function trim ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id srv_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c upper ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function trim ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id UTILITIES ) ) . ( id_expression ( regular_id SERVERNAME ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c upper ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function trim ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id db_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_schema_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_temp>>' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id no_data_found ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_unknown_instance ) ) ) ) ) ; ) ) ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( raise_statement raise ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-2: After RAISE exception_util.err_unknown_instance' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id dual ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_id_ranges ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id id_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_id_type ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_instances ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id srv_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id UTILITIES ) ) . ( id_expression ( regular_id SERVERNAME ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id db_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_schema_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id no_data_found ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_no_range ) ) ) ) ) ; ) ) ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-3: RAISE exception_util.err_no_range' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id dual ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id user_tab_columns ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id column_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key_column ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id no_data_found ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_no_object ) ) ) ) ) ; ) ) ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( raise_statement raise ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-4:  RAISE exception_util.err_no_object' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-0:Finding unique identifier.' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id column_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_iden ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id user_tab_identity_cols ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id no_data_found ) ) ) ) THEN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id index_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_key ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id user_indexes ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id uniqueness ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'UNIQUE' ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( fetch_clause fetch first rows only ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id no_data_found ) ) ) ) THEN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_iden - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '   ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_key - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_no_ident ) ) ) ) ) ; ) END IF ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) THEN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ', CAST(' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' AS number(18)) ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ', ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_where ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'WHERE ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '.' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' = t.' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_iden ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_t ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ( else_part ELSE ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_where ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_t ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Before LISTAGG' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( within_or_over_clause_keyword LISTAGG ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id column_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ',' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( within_or_over_part WITHIN GROUP ( ( order_by_clause ORDER BY ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id column_position ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias AS ( identifier ( id_expression ( regular_id cols ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( within_or_over_clause_keyword LISTAGG ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '.' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id column_name ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' = t.' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id column_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' AND ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( within_or_over_part WITHIN GROUP ( ( order_by_clause ORDER BY ( order_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id column_position ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias AS ( identifier ( id_expression ( regular_id whr ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_colist ) ) ) , ( variable_name ( id_expression ( regular_id v_whr_clause ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id user_indexes ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ui ) ) ) ) ) ( join_clause INNER JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id user_ind_columns ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id uic ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id uic ) ) . ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id index_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id uic ) ) . ( id_expression ( regular_id index_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id uniqueness ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'UNIQUE' ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id index_name ) ) ) ) ) ) ) ) NOT IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id index_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id user_ind_columns ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id column_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key_column ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWNUM ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ui ) ) . ( id_expression ( regular_id index_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id no_data_found ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_no_unique ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'After LISTAGG' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_colist - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_colist ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_whr_clause - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_whr_clause ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ', ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_colist ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_where ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_where ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_t ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'WHERE ' ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'AND ' ) ) ) ) ) ) ) ) ) ) ) ) END ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_whr_clause ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ', ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) ) END IF ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Before EXECUTE IMMEDIATE' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rows ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'SELECT COUNT(*) FROM ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_sql-->' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body Begin ( seq_of_statements ( statement ( sql_statement ( execute_immediate EXECUTE IMMEDIATE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_rows ) ) ) ) ) ) ) ; ) Exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( raise_statement Raise ( exception_name ( identifier ( id_expression ( regular_id e_failed ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Error EXECUTE IMMEDIATE' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_id_type - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_id_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body Begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id r1 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id current_value ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r1 ) ) . ( id_expression ( regular_id max_value ) ) ) ) ) ) ) ) - ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r1 ) ) . ( id_expression ( regular_id current_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_cur ) ) ) , ( variable_name ( id_expression ( regular_id v_left ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_id_ranges ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id r1 ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r1 ) ) . ( id_expression ( regular_id min_value ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function MAX ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r2 ) ) . ( id_expression ( regular_id min_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_id_ranges ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id r2 ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r2 ) ) . ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r1 ) ) . ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r2 ) ) . ( id_expression ( regular_id id_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r1 ) ) . ( id_expression ( regular_id id_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r1 ) ) . ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id i ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_instances ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id i ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i ) ) . ( id_expression ( regular_id srv_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id UTILITIES ) ) . ( id_expression ( regular_id SERVERNAME ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i ) ) . ( id_expression ( regular_id db_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_schema_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r1 ) ) . ( id_expression ( regular_id id_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_id_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) Exception ( exception_handler When ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( raise_statement Raise ( exception_name ( identifier ( id_expression ( regular_id e_failed ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Error vleft ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_cur - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_cur ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '   ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_left - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_left ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_rows - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rows ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_left ) ) ) ) ) ) ) ) ) ) ( relational_operator < ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rows ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_not_enough_keys ) ) ) ) ) ; ) END IF ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Determine key_column base type' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'NUMBER' ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_scale ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' NUMBER(' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_precision ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ') ' ) ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' NUMBER(' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_precision ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ',' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_scale ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ') ' ) ) ) ) ) ) ) ) ) ) ) ) ) END ) ) ) ) ) ) ) ) ) ) ) ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'DATE' ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' DATE ' ) ) ) ) ) ) ) ) ) ) ) ) ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c instr ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CHAR' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_type ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '(' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_length ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ') ' ) ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id data_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) END ( label_name ( id_expression ( regular_id col_datatype ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_basetype ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id user_tab_columns ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id utc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utc ) ) . ( id_expression ( regular_id table_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utc ) ) . ( id_expression ( regular_id column_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key_column ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_basetype ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_basetype ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_datatype ) ) ) ) ) ; ) END IF ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Assign new IDs' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'assign_key_tt' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement Raise ( exception_name ( identifier ( id_expression ( regular_id e_failed ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' Failed to  DROP/TRUNCATE TABLE assign_key_tt: ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' v_key - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '    ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_cur - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function TO_CHAR ( ( table_element ( id_expression ( regular_id v_cur ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_where - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_where ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'insert into assign_key_tt SELECT rownum id12345678id12345678' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CAST(0 AS number(18)) key1234567key1234567' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' FROM ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_sql 1 - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( execute_immediate EXECUTE IMMEDIATE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant null ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'UPDATE assign_key_tt ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'SET    key1234567key1234567 = id12345678id12345678 - 1 +' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function TO_CHAR ( ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_cur ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_sql 2 - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( execute_immediate EXECUTE IMMEDIATE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant null ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'UPDATE ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vtable_name ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'SET ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_key_column ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' =(Select CAST(key1234567key1234567 AS ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_basetype ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ') ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'FROM   assign_key_tt t' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_where ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ')' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'v_sql 3 - ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( execute_immediate EXECUTE IMMEDIATE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_sql ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body Begin ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( update_statement UPDATE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_id_ranges ) ) ) ) ) ) ( update_set_clause SET ( column_based_update_set_clause ( column_name ( identifier ( id_expression ( regular_id current_value ) ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_cur ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rows ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id proxy_id_ranges ) ) . ( id_expression ( regular_id min_value ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function MAX ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r2 ) ) . ( id_expression ( regular_id min_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_id_ranges ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id r2 ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r2 ) ) . ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id proxy_id_ranges ) ) . ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r2 ) ) . ( id_expression ( regular_id id_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id proxy_id_ranges ) ) . ( id_expression ( regular_id id_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id proxy_id_ranges ) ) . ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id i ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id instance_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id proxy_instances ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id i ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i ) ) . ( id_expression ( regular_id srv_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id UTILITIES ) ) . ( id_expression ( regular_id SERVERNAME ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i ) ) . ( id_expression ( regular_id db_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_schema_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id proxy_id_ranges ) ) . ( id_expression ( regular_id id_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_id_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) Exception ( exception_handler when ( exception_name ( identifier ( id_expression ( regular_id others ) ) ) ) then ( seq_of_statements ( statement ( raise_statement Raise ( exception_name ( identifier ( id_expression ( regular_id e_failed ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_LINE ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id PLSQL_UNIT ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Update Failed: ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) End ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id e_failed ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id geterror ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( sql_statement ( transaction_control_statements ( rollback_statement ROLLBACK ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id geterror ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ( label_name ( id_expression ( regular_id assign_id_ranges ) ) ) ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
D:\projects\plsqlcode\bhf_cross_fac.sql
(sql_script (unit_statement (create_procedure_body create or replace procedure (procedure_name (identifier (id_expression (regular_id BHF_CROSS_FAC)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id SYSTEM_ID))))) , (parameter (parameter_name (identifier (id_expression (regular_id v_reporting_date)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id dsa_reporting_date))))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_procname))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id procedure_name)))) ;))) (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_procname)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_dup_fac_ids)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id RAW_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id ORIG_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c SOURCE))))) , (column_name (identifier (id_expression (regular_id BASE)))) , (column_name (identifier (id_expression (regular_id NEW_FACILITY_ID))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id new_fac) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id old_fac)) . (id_expression (regular_id orig_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'M'))))))))))))) (column_alias (identifier (id_expression (regular_id (non_reserved_keywords_pre12c source)))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWNUM)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id new_fac)) . (id_expression (regular_id facility_id))))))))))))))) (column_alias (identifier (id_expression (regular_id new_facility_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_facility)))))) (table_alias (identifier (id_expression (regular_id new_fac)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_orig_facility_id)))))) (table_alias (identifier (id_expression (regular_id old_fac)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id new_fac)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id old_fac)) . (id_expression (regular_id raw_facility_id)))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_sub_facilities)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id RAW_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id FACILITY_TYPE)))) , (column_name (identifier (id_expression (regular_id FACILITY_PURPOSE_CODE)))) , (column_name (identifier (id_expression (regular_id INITIATING_OFFICE)))) , (column_name (identifier (id_expression (regular_id BOOKING_OFFICE)))) , (column_name (identifier (id_expression (regular_id SEVERITY_RATING)))) , (column_name (identifier (id_expression (regular_id ORIG_FACILITY_CCY)))) , (column_name (identifier (id_expression (regular_id LIMIT_START_DATE)))) , (column_name (identifier (id_expression (regular_id LIMIT_END_DATE)))) , (column_name (identifier (id_expression (regular_id SYSTEM_ID)))) , (column_name (identifier (id_expression (regular_id REPORTING_DATE)))) , (column_name (identifier (id_expression (regular_id ORIG_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id MULTI_CCY_INDICATOR)))) , (column_name (identifier (id_expression (regular_id COMMITTED_INDICATOR)))) , (column_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c SOURCE)))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id f) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id D)) . (id_expression (regular_id new_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function NVL ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id f)) . (id_expression (regular_id facility_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id facility_type))))))))))))) ))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id f)) . (id_expression (regular_id facility_purpose_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ppfo)) . (id_expression (regular_id initiating_office))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ppfo)) . (id_expression (regular_id booking_office))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id severity_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_ccy))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id limit_start_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id limit_end_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id D)) . (id_expression (regular_id orig_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id multi_ccy_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id committed_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id D)) . (id_expression (regular_id (non_reserved_keywords_pre12c source)))))))))))))))) (column_alias (identifier (id_expression (regular_id (non_reserved_keywords_pre12c source)))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_facility)))))) (table_alias (identifier (id_expression (regular_id f)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_dup_fac_ids)))))) (table_alias (identifier (id_expression (regular_id D)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_offices)))))) (table_alias (identifier (id_expression (regular_id ppfo)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_default_fac_type)))))) (table_alias (identifier (id_expression (regular_id ft)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id f)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id D)) . (id_expression (regular_id raw_facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id f)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ppfo)) . (id_expression (regular_id raw_facility_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id f)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (table_element (id_expression (regular_id ft)) . (id_expression (regular_id raw_facility_id))) (outer_join_sign ( + ))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_total)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id ORIG_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id COUNT_TOTAL)))) , (column_name (identifier (id_expression (regular_id RAW_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id MULTI_CCY_INDICATOR))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function COUNT ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id multi_ccy_indicator)))))))) ) (over_clause over ( (query_partition_clause partition by (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))))) ))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id multi_ccy_indicator)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_sub_facilities))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_no_total)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id ORIG_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id COUNT_NO)))) , (column_name (identifier (id_expression (regular_id RAW_FACILITY_ID))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function COUNT ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id multi_ccy_indicator)))))))) ) (over_clause over ( (query_partition_clause partition by (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))))) ))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_sub_facilities)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id multi_ccy_indicator)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N')))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_multi_ccy_indicator)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id ORIG_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id RAW_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id MULTI_CCY_INDICATOR))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id t) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id count_total)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id N)) . (id_expression (regular_id count_no)))))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y')))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id multi_ccy_indicator)))))))))))))) END)))))))))))) (column_alias as (identifier (id_expression (regular_id multi_ccy_indicator))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_total)))))) (table_alias (identifier (id_expression (regular_id t)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_no_total)))))) (table_alias (identifier (id_expression (regular_id N)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id N)) . (id_expression (regular_id raw_facility_id)))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_multi_ccy_indicator)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id)))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_multi_ccy_indicator))))))))))))) )))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_multi_ccy_indicator)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id raw_facility_id)))) , (column_name (identifier (id_expression (regular_id multi_ccy_indicator)))) , (column_name (identifier (id_expression (regular_id change_or_default))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id multi_ccy_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'C')))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_multi_ccy_indicator))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id TRUNCATE_TABLE))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_total')))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id TRUNCATE_TABLE))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_no_total')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_child_committed_indicator)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id ORIG_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id RAW_FACILITY_ID)))) , (column_name (identifier (id_expression (regular_id COMMITTED_INDICATOR))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id b) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function COUNT ( (concatenation (model_expression (unary_expression (standard_function (string_function NVL ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id val)) . (id_expression (regular_id committed_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id committed_indicator))))))))))))) )))))) ) (over_clause over ( (query_partition_clause partition by (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id orig_facility_id))))))))))))))) )))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function COUNT ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id orig_facility_id)))))))) ) (over_clause over ( (query_partition_clause partition by (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id orig_facility_id))))))))))))))) )))))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'U')))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'C')))))))))))) END (label_name (id_expression (regular_id committed_indicator)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_committed)))))) (table_alias (identifier (id_expression (regular_id val)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_sub_facilities)))))) (table_alias (identifier (id_expression (regular_id a)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_sub_facilities)))))) (table_alias (identifier (id_expression (regular_id b)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (table_element (id_expression (regular_id val)) . (id_expression (regular_id raw_facility_id))) (outer_join_sign ( + ))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (table_element (id_expression (regular_id a)) . (id_expression (regular_id raw_facility_id))) (outer_join_sign ( + )))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (table_element (id_expression (regular_id a)) . (id_expression (regular_id committed_indicator))) (outer_join_sign ( + )))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'U')))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (table_element (id_expression (regular_id val)) . (id_expression (regular_id committed_indicator))) (outer_join_sign ( + )))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'U'))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_committed)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id pp_fac_committed) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_committed)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_child_committed_indicator)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pp_fac_committed)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_child_committed_indicator)) . (id_expression (regular_id raw_facility_id)))))))))))))))))) )))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_committed)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id raw_facility_id)))) , (column_name (identifier (id_expression (regular_id committed_indicator))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id committed_indicator)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_child_committed_indicator))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id raw_facility)))) (table_alias (identifier (id_expression (regular_id old_values)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id old_values) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id new_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'S'))))))))))))) (column_alias as (identifier (id_expression (regular_id limit_type_ind))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_dup_fac_ids)))))) (table_alias (identifier (id_expression (regular_id new_values)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_facility)))))) (table_alias (identifier (id_expression (regular_id old_values)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id old_values)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id new_values)) . (id_expression (regular_id raw_facility_id))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id old_values)) . (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id facility_id)))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id new_facility_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id limit_type_indicator)))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id limit_type_ind)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id higher_level_facility_id)))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_orig_facility_id)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id raw_facility_id)))) , (column_name (identifier (id_expression (regular_id orig_facility_id))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_dup_fac_ids)))))) (table_alias (identifier (id_expression (regular_id d1)))))))) (where_clause WHERE (expression (logical_expression NOT (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_orig_facility_id)))))) (table_alias (identifier (id_expression (regular_id d2)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d1)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d2)) . (id_expression (regular_id raw_facility_id)))))))))))))))))) ))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id pp_fac_ultimates)))) (table_alias (identifier (id_expression (regular_id old_fac)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id old_fac) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function cast ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id new_fac)) . (id_expression (regular_id facility_id)))))))) as (type_spec (datatype (native_datatype_element varchar2) (precision_part ( (numeric 30) )))) ))))))))))))) (column_alias AS (identifier (id_expression (regular_id new_facility_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'S'))))))))))))) (column_alias as (identifier (id_expression (regular_id limit_type_ind))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) (column_alias as (identifier (id_expression (regular_id hiery_level))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id orig_facility_id))))))))))))))) (column_alias as (identifier (id_expression (regular_id parent_facility_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_fac_ultimates)))))) (table_alias (identifier (id_expression (regular_id old_fac)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_sub_facilities)))))) (table_alias (identifier (id_expression (regular_id new_fac)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id old_fac)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id new_fac)) . (id_expression (regular_id raw_facility_id))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id old_fac)) . (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id old_fac))) . (id_expression (regular_id facility_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id new_facility_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id old_fac))) . (id_expression (regular_id highest_level_facility_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id orig_facility_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id old_fac))) . (id_expression (regular_id limit_type_indicator))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id limit_type_ind)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id old_fac))) . (id_expression (regular_id hierarchy_level))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id hiery_level)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id old_fac))) . (id_expression (regular_id parent_facility_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id parent_facility_id))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'end')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\bhf_cross_fac.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body create or replace procedure (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id BHF_CROSS_FAC)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id SYSTEM_ID ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_reporting_date ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id dsa_reporting_date ) ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_procname ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id procedure_name ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_dup_fac_ids ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id RAW_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ORIG_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c SOURCE ) ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id BASE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id NEW_FACILITY_ID ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id new_fac ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id old_fac ) ) . ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'M' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c source ) ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWNUM ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id new_fac ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id new_facility_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id new_fac ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_orig_facility_id ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id old_fac ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id new_fac ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id old_fac ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_sub_facilities ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id RAW_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id FACILITY_TYPE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id FACILITY_PURPOSE_CODE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id INITIATING_OFFICE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id BOOKING_OFFICE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id SEVERITY_RATING ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ORIG_FACILITY_CCY ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id LIMIT_START_DATE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id LIMIT_END_DATE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id SYSTEM_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id REPORTING_DATE ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ORIG_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id MULTI_CCY_INDICATOR ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id COMMITTED_INDICATOR ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c SOURCE ) ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id f ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id D ) ) . ( id_expression ( regular_id new_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function NVL ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id f ) ) . ( id_expression ( regular_id facility_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id facility_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id f ) ) . ( id_expression ( regular_id facility_purpose_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ppfo ) ) . ( id_expression ( regular_id initiating_office ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ppfo ) ) . ( id_expression ( regular_id booking_office ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id severity_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id limit_start_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id limit_end_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id D ) ) . ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id committed_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id D ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c source ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c source ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id f ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_dup_fac_ids ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id D ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_offices ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ppfo ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_default_fac_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ft ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id f ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id D ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id f ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ppfo ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id f ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( table_element ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ( outer_join_sign ( + ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_total ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id ORIG_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id COUNT_TOTAL ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id RAW_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id MULTI_CCY_INDICATOR ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function COUNT ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) ) ) ) ) ) ( over_clause over ( ( query_partition_clause partition by ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_sub_facilities ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_no_total ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id ORIG_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id COUNT_NO ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id RAW_FACILITY_ID ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function COUNT ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) ) ) ) ) ) ( over_clause over ( ( query_partition_clause partition by ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_sub_facilities ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_multi_ccy_indicator ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id ORIG_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id RAW_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id MULTI_CCY_INDICATOR ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id t ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id count_total ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id N ) ) . ( id_expression ( regular_id count_no ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) ) END ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_total ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_no_total ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id N ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id N ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_multi_ccy_indicator ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_multi_ccy_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_multi_ccy_indicator ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id raw_facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id change_or_default ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id multi_ccy_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'C' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_multi_ccy_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id TRUNCATE_TABLE ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_total' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id TRUNCATE_TABLE ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_no_total' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_child_committed_indicator ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id ORIG_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id RAW_FACILITY_ID ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id COMMITTED_INDICATOR ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id b ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function COUNT ( ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function NVL ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id val ) ) . ( id_expression ( regular_id committed_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id committed_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( over_clause over ( ( query_partition_clause partition by ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function COUNT ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ( over_clause over ( ( query_partition_clause partition by ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'U' ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'C' ) ) ) ) ) ) ) ) ) ) ) ) END ( label_name ( id_expression ( regular_id committed_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_committed ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id val ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_sub_facilities ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_sub_facilities ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( table_element ( id_expression ( regular_id val ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ( outer_join_sign ( + ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( table_element ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ( outer_join_sign ( + ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( table_element ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id committed_indicator ) ) ) ( outer_join_sign ( + ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'U' ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( table_element ( id_expression ( regular_id val ) ) . ( id_expression ( regular_id committed_indicator ) ) ) ( outer_join_sign ( + ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'U' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_committed ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id pp_fac_committed ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_committed ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_child_committed_indicator ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pp_fac_committed ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_child_committed_indicator ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_committed ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id raw_facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id committed_indicator ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id committed_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_child_committed_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id raw_facility ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id old_values ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id old_values ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id new_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'S' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id limit_type_ind ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_dup_fac_ids ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id new_values ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id old_values ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id old_values ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id new_values ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id old_values ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id new_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id limit_type_indicator ) ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id limit_type_ind ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id higher_level_facility_id ) ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_orig_facility_id ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id raw_facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_dup_fac_ids ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d1 ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression NOT ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_orig_facility_id ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d2 ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d1 ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d2 ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_ultimates ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id old_fac ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id old_fac ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function cast ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id new_fac ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) as ( type_spec ( datatype ( native_datatype_element varchar2 ) ( precision_part ( ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias AS ( identifier ( id_expression ( regular_id new_facility_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'S' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id limit_type_ind ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id hiery_level ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id parent_facility_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_fac_ultimates ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id old_fac ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_sub_facilities ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id new_fac ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id old_fac ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id new_fac ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id old_fac ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id old_fac ) ) ) . ( id_expression ( regular_id facility_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id new_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id old_fac ) ) ) . ( id_expression ( regular_id highest_level_facility_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id orig_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id old_fac ) ) ) . ( id_expression ( regular_id limit_type_indicator ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id limit_type_ind ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id old_fac ) ) ) . ( id_expression ( regular_id hierarchy_level ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id hiery_level ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id old_fac ) ) ) . ( id_expression ( regular_id parent_facility_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id parent_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'end' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
D:\projects\plsqlcode\business_finalize.sql
(sql_script (unit_statement (create_procedure_body create or replace procedure (procedure_name (identifier (id_expression (regular_id BUSINESS_FINALIZE)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id SYSTEM_ID))))) , (parameter (parameter_name (identifier (id_expression (regular_id v_reporting_date)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id dsa_reporting_date))))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_procname))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id procedure_name)))) ;))) (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_procname)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id exception)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id e) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id exception)))))) (table_alias (identifier (id_expression (regular_id e)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_cus)))))) (table_alias (identifier (id_expression (regular_id rcc)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer)))))) (table_alias (identifier (id_expression (regular_id rc)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id local_customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id local_customer_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcc)) . (id_expression (regular_id raw_customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id raw_customer_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id grid_customer)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y')))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id exception_code)))))))) IN (in_elements ( (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'INDUSTRYMISB')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'INDUSTRYMAPB')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CUSTTYPEMISB')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CUSTTYPEMAPB')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CTRYRESMISB')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CTRYRESMAPB')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CTRYRESSDFB')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CUSTTYPESDFB')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'INDUSTRYSDFB')))))) )))))))))))) )))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'end')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLCODE)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\business_finalize.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body create or replace procedure (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id BUSINESS_FINALIZE)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id SYSTEM_ID ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_reporting_date ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id dsa_reporting_date ) ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_procname ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id procedure_name ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id exception ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id e ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id exception ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_cus ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rcc ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcc ) ) . ( id_expression ( regular_id raw_customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id raw_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id grid_customer ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id exception_code ) ) ) ) ) ) ) ) IN ( in_elements ( ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'INDUSTRYMISB' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'INDUSTRYMAPB' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CUSTTYPEMISB' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CUSTTYPEMAPB' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CTRYRESMISB' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CTRYRESMAPB' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CTRYRESSDFB' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CUSTTYPESDFB' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'INDUSTRYSDFB' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'end' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLCODE ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
D:\projects\plsqlcode\calc_raw_ultimates.sql
(sql_script (unit_statement (create_procedure_body CREATE OR REPLACE PROCEDURE (procedure_name (identifier (id_expression (regular_id CALC_RAW_ULTIMATES)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id system_id))))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_i))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_xrefexcludelist))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_temp))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 1) , (numeric 0) )))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_procname))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id procname)))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CALC_RAW_ULTIMATES')))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_asch))) (type_spec (datatype (native_datatype_element NUMBER))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_debug_msg))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id debug_msg)))) ;))) (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id parameter_value)))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_xrefexcludelist)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id global_parameters)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id parameter_name)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'XREF_EXCLUDE_LIST')))))))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'raw_customer_ultimates')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id complete_bitwise)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id rcc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gbc)) . (id_expression (regular_id legal_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gbc)) . (id_expression (regular_id econ_imm_parent_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_cus)))))) (table_alias (identifier (id_expression (regular_id rcc))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id gbc))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gbc)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcc)) . (id_expression (regular_id grid_customer)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Y')))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' raw_customer_ultimates '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id complete_bitwise)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id rcc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id m)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id m)) . (id_expression (regular_id customer_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_cus)))))) (table_alias (identifier (id_expression (regular_id rcc))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer)))))) (table_alias (identifier (id_expression (regular_id rc))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcc)) . (id_expression (regular_id raw_customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id raw_customer_id))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id customer_id_mapping)))))) (table_alias (identifier (id_expression (regular_id m))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id legal_imm_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id m)) . (id_expression (regular_id local_customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))) (table_alias (identifier (id_expression (regular_id u))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id u)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id m)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id u)) . (id_expression (regular_id customer_id))))))))))) IS NULL)) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id m)) . (id_expression (regular_id status))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'GEN'))))))))))) )))))) NOT IN (in_elements ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_xrefexcludelist)))))))) )))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' raw_customer_ultimates '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id complete_bitwise)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id rcc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id lbc)) . (id_expression (regular_id legal_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id lbc)) . (id_expression (regular_id econ_imm_parent_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_cus)))))) (table_alias (identifier (id_expression (regular_id rcc))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id lbc))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id lbc)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))) (table_alias (identifier (id_expression (regular_id u))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rcc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id u)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id u)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' raw_customer_ultimates '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_i)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'Calculate UltP based on retrieved ImmP')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_asch)))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id dual)))))))))) (where_clause where (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression exists ( (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id complete_bitwise)))))))))) (relational_operator <) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 3)))))))))))))))) )))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id no_data_found)))) THEN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_asch)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))))) ;)) END)) ; (statement (loop_statement WHILE (condition (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_asch)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_i)))))))))) (relational_operator <) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 100)))))))))))))) ))))))))))) LOOP (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement merge into (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))) using (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (regular_id raw_customer_ultimates) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id legal_ult_parent_id)))))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) END))))) + (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id econ_ult_parent_id)))))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 2)))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) END (label_name (id_expression (regular_id complete_bitwise))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))) (table_alias (identifier (id_expression (regular_id l)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_customer_ultimates)))))) (table_alias (identifier (id_expression (regular_id e)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_customer_ultimates)) . (id_expression (regular_id legal_ult_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_customer_ultimates)) . (id_expression (regular_id econ_ult_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_customer_ultimates)) . (id_expression (regular_id complete_bitwise)))))))))) (relational_operator <) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 3)))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) on ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_customer_ultimates)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause when matched then update set (merge_element (column_name (identifier (id_expression (regular_id raw_customer_ultimates))) . (id_expression (regular_id legal_ult_parent_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id legal_ult_parent_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id raw_customer_ultimates))) . (id_expression (regular_id econ_ult_parent_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id econ_ult_parent_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id raw_customer_ultimates))) . (id_expression (regular_id complete_bitwise))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id complete_bitwise))))))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_i)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_i)))))))) + (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) ;) END)) ;) END LOOP)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' raw_customer_ultimates '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'end')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) <EOF>)
D:\projects\plsqlcode\calc_raw_ultimates.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body CREATE OR REPLACE PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id CALC_RAW_ULTIMATES)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_i ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_xrefexcludelist ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_temp ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 1 ) , ( numeric 0 ) ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_procname ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id procname ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CALC_RAW_ULTIMATES' ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_asch ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_debug_msg ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id debug_msg ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id parameter_value ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_xrefexcludelist ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id global_parameters ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id parameter_name ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'XREF_EXCLUDE_LIST' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'raw_customer_ultimates' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id complete_bitwise ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id rcc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gbc ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gbc ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_cus ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rcc ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id gbc ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gbc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcc ) ) . ( id_expression ( regular_id grid_customer ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Y' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' raw_customer_ultimates ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id complete_bitwise ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id rcc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id m ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id m ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_cus ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rcc ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rc ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcc ) ) . ( id_expression ( regular_id raw_customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id raw_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id customer_id_mapping ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id m ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id m ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id u ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id u ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id m ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id u ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id m ) ) . ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'GEN' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) NOT IN ( in_elements ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_xrefexcludelist ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' raw_customer_ultimates ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id complete_bitwise ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id rcc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id lbc ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id lbc ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_cus ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rcc ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id lbc ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id lbc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id u ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rcc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id u ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id u ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' raw_customer_ultimates ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_i ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'Calculate UltP based on retrieved ImmP' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_asch ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id dual ) ) ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression exists ( ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id complete_bitwise ) ) ) ) ) ) ) ) ) ) ( relational_operator < ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id no_data_found ) ) ) ) THEN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_asch ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( loop_statement WHILE ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_asch ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_i ) ) ) ) ) ) ) ) ) ) ( relational_operator < ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 100 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) LOOP ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement merge into ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) using ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( regular_id raw_customer_ultimates ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) END ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) END ( label_name ( id_expression ( regular_id complete_bitwise ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_customer_ultimates ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_customer_ultimates ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_customer_ultimates ) ) . ( id_expression ( regular_id complete_bitwise ) ) ) ) ) ) ) ) ) ) ( relational_operator < ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) on ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_customer_ultimates ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause when matched then update set ( merge_element ( column_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id raw_customer_ultimates ) ) ) . ( id_expression ( regular_id complete_bitwise ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id complete_bitwise ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_i ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_i ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) END LOOP ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' raw_customer_ultimates ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'end' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) < EOF > ))
D:\projects\plsqlcode\changed_customers.sql
(sql_script (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier (id_expression (regular_id changed_customers)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id system_id))))) , (parameter (parameter_name (identifier (id_expression (regular_id v_reporting_date)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id dsa_reporting_date))))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_rc))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_crc))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_localcust))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 10) , (numeric 0) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_load_key))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_txt))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 255) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_temp))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) , (numeric 0) )))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_procname))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id procedure_name)))) ;))) (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_localcust)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 99999999))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_procname)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id load_key)))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_load_key)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id dsa_dwh_synchronisation)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reporting_date)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_load_key))))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'export_basic_customer')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_clear))))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'export_derived_customer')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_clear))))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'export_customer_identification')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_clear))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-0: Finished clearing export tables'))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_basic_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_name)))) , (column_name (identifier (id_expression (regular_id customer_type)))) , (column_name (identifier (id_expression (regular_id city)))) , (column_name (identifier (id_expression (regular_id metropolitan_area_name)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk)))) , (column_name (identifier (id_expression (regular_id segmentation_code)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_id)))) , (column_name (identifier (id_expression (regular_id influenced_risk_rating)))) , (column_name (identifier (id_expression (regular_id standalone_risk_rating)))) , (column_name (identifier (id_expression (regular_id relationship_start_date)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_date)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_date)))) , (column_name (identifier (id_expression (regular_id branch_indicator)))) , (column_name (identifier (id_expression (regular_id active_status)))) , (column_name (identifier (id_expression (regular_id active_status_detail)))) , (column_name (identifier (id_expression (regular_id source_system)))) , (column_name (identifier (id_expression (regular_id exists_as_id)))) , (column_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c alias))))) , (column_name (identifier (id_expression (regular_id building_name)))) , (column_name (identifier (id_expression (regular_id street_name)))) , (column_name (identifier (id_expression (regular_id postcode)))) , (column_name (identifier (id_expression (regular_id (non_reserved_keywords_in_12c state))))) , (column_name (identifier (id_expression (regular_id total_assets)))) , (column_name (identifier (id_expression (regular_id total_liabilities)))) , (column_name (identifier (id_expression (regular_id net_sales)))) , (column_name (identifier (id_expression (regular_id net_income)))) , (column_name (identifier (id_expression (regular_id total_equity)))) , (column_name (identifier (id_expression (regular_id statement_date)))) , (column_name (identifier (id_expression (regular_id currency_code)))) , (column_name (identifier (id_expression (regular_id reference_limit)))) , (column_name (identifier (id_expression (regular_id reference_limit_ccy)))) , (column_name (identifier (id_expression (regular_id eurogate)))) , (column_name (identifier (id_expression (regular_id graydon_z_score)))) , (column_name (identifier (id_expression (regular_id graydon_g_score)))) , (column_name (identifier (id_expression (regular_id next_review_date)))) , (column_name (identifier (id_expression (regular_id parent_account_manager)))) , (column_name (identifier (id_expression (regular_id local_account_manager)))) , (column_name (identifier (id_expression (regular_id primary_risk_manager)))) , (column_name (identifier (id_expression (regular_id distribution_channel)))) , (column_name (identifier (id_expression (regular_id town_code)))) , (column_name (identifier (id_expression (regular_id industry1_code))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 10) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant (quoted_string '')))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id basic_customer_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_name)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id customer_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_type)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 10) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id customer_type))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id city)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 40) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id city))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id city_code)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 60) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id metropolitan_area_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id country_of_residence)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ctry_of_residence))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id country_of_incorporation)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ctry_of_incorporation))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id worst_country_of_risk)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id worst_ctry_of_risk))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id segmentation_code)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 10) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id segmentation_code))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id legal_immediate_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) )))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 10) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id legal_imm_parent_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id economic_immediate_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) )))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 10) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id econ_imm_parent_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id influenced_risk_rating)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 6) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id influenced_risk_rating))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id standalone_risk_rating)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 6) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id standalone_risk_rating))))) , (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id relationship_start_date))))))))))))))) (column_alias (identifier (id_expression (regular_id relationship_start_date))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating_owner)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 10) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id bnk_risk_rating_owner))))) , (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id bnk_risk_rating_date))))))))))))))) (column_alias (identifier (id_expression (regular_id bnk_risk_rating_date))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating_owner)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 10) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ins_risk_rating_owner))))) , (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ins_risk_rating_date))))))))))))))) (column_alias (identifier (id_expression (regular_id ins_risk_rating_date))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id branch_indicator)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 1) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id branch_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id active_status)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id active_status))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id active_status_detail)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id active_status_detail))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id source_system)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id source_system))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id exists_as_id)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 10) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id exists_as_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id (non_reserved_keywords_pre12c alias))))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id (non_reserved_keywords_pre12c alias)))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id building_name)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id building_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id street_name)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id street_name))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id postcode)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id postcode))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id (non_reserved_keywords_in_12c state))))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 100) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id (non_reserved_keywords_in_12c state)))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id total_assets)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 22) , (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id total_assets))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id total_liabilities)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 22) , (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id total_liabilities))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id net_sales)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 22) , (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id net_sales))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id net_income)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 22) , (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id net_income))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id total_equity)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 22) , (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id total_equity))))) , (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id statement_date))))))))))))))) (column_alias (identifier (id_expression (regular_id statement_date))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id currency_code)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id currency_code))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id reference_limit)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 22) , (numeric 2) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id reference_limit))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id reference_limit_ccy)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id reference_limit_ccy))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id eurogate)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id eurogate))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id graydon_z_score)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id graydon_z_score))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id graydon_g_score)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 3) , (numeric 1) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id graydon_g_score))))) , (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id next_review_date))))))))))))))) (column_alias (identifier (id_expression (regular_id next_review_date))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id parent_account_manager)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 30) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id parent_account_manager))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id local_account_manager)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 30) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id local_account_manager))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id primary_risk_manager)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 30) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id primary_risk_manager))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id distribution_channel)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 30) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id distribution_channel))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id town_code)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 30) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id town_code))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id industry1_code)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 10) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id industry1_code))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_localcust)))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_gen_basic))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-1: Generate all basic data from valid_customer for local customer_ids')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_basic_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_name)))) , (column_name (identifier (id_expression (regular_id customer_type)))) , (column_name (identifier (id_expression (regular_id city)))) , (column_name (identifier (id_expression (regular_id metropolitan_area_name)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk)))) , (column_name (identifier (id_expression (regular_id segmentation_code)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_id)))) , (column_name (identifier (id_expression (regular_id influenced_risk_rating)))) , (column_name (identifier (id_expression (regular_id standalone_risk_rating)))) , (column_name (identifier (id_expression (regular_id relationship_start_date)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_risk_rater)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_date)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_risk_rater)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_date)))) , (column_name (identifier (id_expression (regular_id branch_indicator)))) , (column_name (identifier (id_expression (regular_id active_status)))) , (column_name (identifier (id_expression (regular_id active_status_detail)))) , (column_name (identifier (id_expression (regular_id source_system)))) , (column_name (identifier (id_expression (regular_id exists_as_id)))) , (column_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c alias))))) , (column_name (identifier (id_expression (regular_id internal_building_reference)))) , (column_name (identifier (id_expression (regular_id building_name)))) , (column_name (identifier (id_expression (regular_id street_name)))) , (column_name (identifier (id_expression (regular_id postcode)))) , (column_name (identifier (id_expression (regular_id (non_reserved_keywords_in_12c state))))) , (column_name (identifier (id_expression (regular_id total_assets)))) , (column_name (identifier (id_expression (regular_id total_liabilities)))) , (column_name (identifier (id_expression (regular_id net_sales)))) , (column_name (identifier (id_expression (regular_id net_income)))) , (column_name (identifier (id_expression (regular_id total_equity)))) , (column_name (identifier (id_expression (regular_id statement_date)))) , (column_name (identifier (id_expression (regular_id currency_code)))) , (column_name (identifier (id_expression (regular_id reference_limit)))) , (column_name (identifier (id_expression (regular_id reference_limit_ccy)))) , (column_name (identifier (id_expression (regular_id eurogate)))) , (column_name (identifier (id_expression (regular_id graydon_z_score)))) , (column_name (identifier (id_expression (regular_id graydon_g_score)))) , (column_name (identifier (id_expression (regular_id next_review_date)))) , (column_name (identifier (id_expression (regular_id parent_account_manager)))) , (column_name (identifier (id_expression (regular_id local_account_manager)))) , (column_name (identifier (id_expression (regular_id relationship_manager)))) , (column_name (identifier (id_expression (regular_id primary_risk_manager)))) , (column_name (identifier (id_expression (regular_id distribution_channel)))) , (column_name (identifier (id_expression (regular_id town_code)))) , (column_name (identifier (id_expression (regular_id maintenance_unit_id)))) , (column_name (identifier (id_expression (regular_id maintenance_unit)))) , (column_name (identifier (id_expression (regular_id customer_type_cdd_code)))) , (column_name (identifier (id_expression (regular_id customer_type_mifid_code)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_scs_dept_code)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_review_date)))) , (column_name (identifier (id_expression (regular_id approved_signatory_cdd)))) , (column_name (identifier (id_expression (regular_id date_completed_cdd)))) , (column_name (identifier (id_expression (regular_id cdd_scs_dept_code)))) , (column_name (identifier (id_expression (regular_id review_date_cdd)))) , (column_name (identifier (id_expression (regular_id mifid_scs_dept_code)))) , (column_name (identifier (id_expression (regular_id review_date_mifid)))) , (column_name (identifier (id_expression (regular_id last_updated)))) , (column_name (identifier (id_expression (regular_id mifid_approval_date)))) , (column_name (identifier (id_expression (regular_id foundation_date)))) , (column_name (identifier (id_expression (regular_id worst_status)))) , (column_name (identifier (id_expression (regular_id industry1_code)))) , (column_name (identifier (id_expression (regular_id industry2_code)))) , (column_name (identifier (id_expression (regular_id risk_level_cdd_code)))) , (column_name (identifier (id_expression (regular_id classification_mifid_code)))) , (column_name (identifier (id_expression (regular_id cust_segm_pl_code))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id t) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id city))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id metropolitan_area_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_residence))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_incorporation))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id worst_ctry_of_risk))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id influenced_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id standalone_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id relationship_start_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_owner))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_owner))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id branch_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id active_status))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id active_status_detail))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id source_system))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id exists_as_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id (non_reserved_keywords_pre12c alias)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id building_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id street_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id postcode))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id (non_reserved_keywords_in_12c state)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id total_assets))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id total_liabilities))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id net_sales))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id net_income))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id total_equity))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id statement_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id currency_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id reference_limit))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id reference_limit_ccy))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id eurogate))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id graydon_z_score))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id graydon_g_score))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id next_review_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id parent_account_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id local_account_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id primary_risk_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id distribution_channel))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id town_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry1_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_basic_customer)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id b))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id))))))))))) IS NULL) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) ))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id city))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id city))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id metropolitan_area_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id metropolitan_area_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_residence))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id ctry_of_residence))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_incorporation))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id ctry_of_incorporation))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id worst_ctry_of_risk))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id worst_ctry_of_risk))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id segmentation_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id legal_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id econ_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id influenced_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id influenced_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id standalone_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id standalone_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id relationship_start_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id relationship_start_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_owner))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_owner))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_owner))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id ins_risk_rating_owner))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id ins_risk_rating_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id branch_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id branch_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id active_status))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id active_status))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id active_status_detail))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id active_status_detail))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id source_system))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id source_system))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id exists_as_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id exists_as_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id (non_reserved_keywords_pre12c alias)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id (non_reserved_keywords_pre12c alias)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id building_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id building_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id street_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id street_name))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id postcode))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id postcode))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id (non_reserved_keywords_in_12c state)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id (non_reserved_keywords_in_12c state)))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id total_assets))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id total_assets))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id total_liabilities))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id total_liabilities))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id net_sales))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id net_sales))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id net_income))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id net_income))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id total_equity))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id total_equity))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id statement_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id statement_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id currency_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id currency_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id reference_limit))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id reference_limit))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id reference_limit_ccy))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id reference_limit_ccy))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id eurogate))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id eurogate))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id graydon_z_score))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id graydon_z_score))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id graydon_g_score))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id graydon_g_score))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id next_review_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id next_review_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '01-01-1900'))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id parent_account_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id parent_account_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id local_account_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id local_account_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id primary_risk_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id primary_risk_manager))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id distribution_channel))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id distribution_channel))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id town_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id town_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry1_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id industry1_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))))) ))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement raise)) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-2: Add all new and changed records to export_basic_customer')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_basic_customer))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_basic_iden))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-3: Add customer_ids to identification table')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id assign_id_ranges)))) (function_argument ( (argument (identifier (id_expression (regular_id p_id_type))) = > (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'BASIC_CUSTOMER_KEY')))))))))))) , (argument (identifier (id_expression (regular_id p_table_name))) = > (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'export_customer_identification')))))))))))) , (argument (identifier (id_expression (regular_id p_key_column))) = > (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'basic_customer_key')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_gen_basic_ck))))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id export_basic_customer)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id export_basic_customer) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id export_customer_identification) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_basic_customer)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_customer_identification)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_basic_customer)) . (id_expression (regular_id customer_id))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_basic_customer)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id export_basic_customer))) . (id_expression (regular_id basic_customer_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id basic_customer_key))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_basic_ck))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-4: Assign new basic_customer_keys')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function COUNT ( (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))) ))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_rc)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key))))))))))) IS NULL)))))))))) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_basic_iden))))) ;) END IF)) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_derived_customer')))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_derived_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id generated_record)))) , (column_name (identifier (id_expression (regular_id grid_interface)))) , (column_name (identifier (id_expression (regular_id load_key)))) , (column_name (identifier (id_expression (regular_id customer_type_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation_key)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id regulated_indicator)))) , (column_name (identifier (id_expression (regular_id customer_type_cdd_key)))) , (column_name (identifier (id_expression (regular_id customer_type_mifid_key)))) , (column_name (identifier (id_expression (regular_id risk_level_cdd_key)))) , (column_name (identifier (id_expression (regular_id classification_mifid_key)))) , (column_name (identifier (id_expression (regular_id industry1_key)))) , (column_name (identifier (id_expression (regular_id industry2_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_poland_key))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id basic_customer_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id customer_key_nr))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 10) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element DATE))) ))))))))))))) (column_alias (identifier (id_expression (regular_id record_valid_from))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element DATE))) ))))))))))))) (column_alias (identifier (id_expression (regular_id record_valid_until))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id system_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id generated_record)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 1) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id generated_record))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 1) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id grid_interface))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id load_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ct)) . (id_expression (regular_id customer_type_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id customer_type_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c1)) . (id_expression (regular_id country_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ctry_of_residence_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c2)) . (id_expression (regular_id country_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ctry_of_incorporation_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c3)) . (id_expression (regular_id country_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id worst_ctry_of_risk_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id segmentation_type_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id segmentation_type_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id risk_rating_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id bnk_risk_rating_risk_rater_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id bo)) . (id_expression (regular_id office_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id bnk_risk_rating_owner_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 6) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id bnk_risk_rating))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrb)) . (id_expression (regular_id risk_rating_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id bnk_risk_rating_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrri)) . (id_expression (regular_id risk_rating_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ins_risk_rating_risk_rater_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id io)) . (id_expression (regular_id office_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ins_risk_rating_owner_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 6) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ins_risk_rating))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rri)) . (id_expression (regular_id risk_rating_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ins_risk_rating_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id legal_ultimate_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) )))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 10) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id legal_ult_parent_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id economic_ultimate_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) )))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 10) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id econ_ult_parent_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id legal_imm_parent_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id legal_ult_parent_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id econ_imm_parent_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (constant NULL))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 18) , (numeric 0) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id econ_ult_parent_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating_source)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id bnk_risk_rating_source))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating_source)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 3) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id ins_risk_rating_source))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id regulated_indicator)))))))) AS (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 1) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id regulated_indicator))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cdd)) . (id_expression (regular_id customer_type_cdd_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id customer_type_cdd_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mifid)) . (id_expression (regular_id customer_type_mifid_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id customer_type_mifid_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rl)) . (id_expression (regular_id risk_level_cdd_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id risk_level_cdd_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cm)) . (id_expression (regular_id classification_mifid_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id classification_mifid_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i1)) . (id_expression (regular_id industry_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ix)) . (id_expression (regular_id industry_type_key))))))))))))) )))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id industry1_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i2)) . (id_expression (regular_id industry_type_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id industry2_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function CAST ( (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pl)) . (id_expression (regular_id segmentation_type_key)))))))) AS (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ))))))))))))) (column_alias (identifier (id_expression (regular_id segmentation_type_poland_key))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_country)))))) (table_alias (identifier (id_expression (regular_id c1))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id country_of_residence)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c1)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_country)))))) (table_alias (identifier (id_expression (regular_id c2))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id country_of_incorporation)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c2)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_country)))))) (table_alias (identifier (id_expression (regular_id c3))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id worst_country_of_risk)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c3)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_segmentation_type)))))) (table_alias (identifier (id_expression (regular_id st))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id segmentation_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_customer_type)))))) (table_alias (identifier (id_expression (regular_id ct))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ct)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rrb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrb)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rri))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rri)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_office)))))) (table_alias (identifier (id_expression (regular_id bo))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating_owner)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id bo)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_office)))))) (table_alias (identifier (id_expression (regular_id io))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating_owner)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id io)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id gb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rrrrb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rrrri))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id ins_risk_rating_risk_rater)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrri)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_customer_type_cdd)))))) (table_alias (identifier (id_expression (regular_id cdd))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id customer_type_cdd_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cdd)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_customer_type_mifid)))))) (table_alias (identifier (id_expression (regular_id mifid))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id customer_type_mifid_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id mifid)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_level_cdd)))))) (table_alias (identifier (id_expression (regular_id rl))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id risk_level_cdd_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rl)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_classification_mifid)))))) (table_alias (identifier (id_expression (regular_id cm))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id classification_mifid_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id cm)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_industry_type)))))) (table_alias (identifier (id_expression (regular_id i1))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id industry1_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i1)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_industry_type)))))) (table_alias (identifier (id_expression (regular_id i2))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id industry2_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i2)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_industry_type)))))) (table_alias (identifier (id_expression (regular_id ix))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id industry1_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ix)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_cust_segm_pl)))))) (table_alias (identifier (id_expression (regular_id pl))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id cust_segm_pl_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pl)) . (id_expression (regular_id code))))))))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_gen_derived))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-5: Generate all derived data from valid_customer for all customer_ids')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id generated_record)))) , (column_name (identifier (id_expression (regular_id grid_interface)))) , (column_name (identifier (id_expression (regular_id load_key)))) , (column_name (identifier (id_expression (regular_id customer_type_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation_key)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id regulated_indicator)))) , (column_name (identifier (id_expression (regular_id customer_type_cdd_key)))) , (column_name (identifier (id_expression (regular_id customer_type_mifid_key)))) , (column_name (identifier (id_expression (regular_id risk_level_cdd_key)))) , (column_name (identifier (id_expression (regular_id classification_mifid_key)))) , (column_name (identifier (id_expression (regular_id industry1_key)))) , (column_name (identifier (id_expression (regular_id industry2_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_poland_key))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id t) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_key_nr))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id record_valid_from))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id record_valid_until))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id generated_record))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id grid_interface))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id load_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_imm_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_imm_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id risk_level_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id classification_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry2_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_poland_key)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_derived_customer)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id g))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id gb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rrrrb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id code)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) ))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ins_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ins_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_type_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_type_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id risk_level_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id risk_level_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id classification_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id classification_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry2_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id industry2_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_poland_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id segmentation_type_poland_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) ))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_der_grid))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-6: Add all changed GRID records to export_derived_customer')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id generated_record)))) , (column_name (identifier (id_expression (regular_id grid_interface)))) , (column_name (identifier (id_expression (regular_id load_key)))) , (column_name (identifier (id_expression (regular_id customer_type_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation_key)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id regulated_indicator)))) , (column_name (identifier (id_expression (regular_id customer_type_cdd_key)))) , (column_name (identifier (id_expression (regular_id customer_type_mifid_key)))) , (column_name (identifier (id_expression (regular_id risk_level_cdd_key)))) , (column_name (identifier (id_expression (regular_id classification_mifid_key)))) , (column_name (identifier (id_expression (regular_id industry1_key)))) , (column_name (identifier (id_expression (regular_id industry2_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_poland_key))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id t) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_key_nr))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id record_valid_from))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id record_valid_until))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id generated_record))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id grid_interface))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id load_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_imm_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_imm_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id risk_level_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id classification_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry2_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_poland_key)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_derived_customer)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id d))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id b))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rrrrb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 2)))))))))))) ))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_der_grid_basic_key))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-6.2: Add all changed basic GRID records to export_derived_customer')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id generated_record)))) , (column_name (identifier (id_expression (regular_id grid_interface)))) , (column_name (identifier (id_expression (regular_id load_key)))) , (column_name (identifier (id_expression (regular_id customer_type_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation_key)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id regulated_indicator)))) , (column_name (identifier (id_expression (regular_id customer_type_cdd_key)))) , (column_name (identifier (id_expression (regular_id customer_type_mifid_key)))) , (column_name (identifier (id_expression (regular_id risk_level_cdd_key)))) , (column_name (identifier (id_expression (regular_id classification_mifid_key)))) , (column_name (identifier (id_expression (regular_id industry1_key)))) , (column_name (identifier (id_expression (regular_id industry2_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_poland_key))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id t) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_key_nr))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id record_valid_from))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id record_valid_until))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id generated_record))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id grid_interface))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id load_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_imm_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_imm_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id risk_level_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id classification_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry2_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_poland_key)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_derived_customer)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_derived_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) ))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))))))) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) ))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_der_local))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-7: Add all changed LOCAL records to export_derived_customer')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id generated_record)))) , (column_name (identifier (id_expression (regular_id grid_interface)))) , (column_name (identifier (id_expression (regular_id load_key)))) , (column_name (identifier (id_expression (regular_id customer_type_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation_key)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id regulated_indicator)))) , (column_name (identifier (id_expression (regular_id customer_type_cdd_key)))) , (column_name (identifier (id_expression (regular_id customer_type_mifid_key)))) , (column_name (identifier (id_expression (regular_id risk_level_cdd_key)))) , (column_name (identifier (id_expression (regular_id classification_mifid_key)))) , (column_name (identifier (id_expression (regular_id industry1_key)))) , (column_name (identifier (id_expression (regular_id industry2_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_poland_key))))) ))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id generated_record))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ct)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c1)) . (id_expression (regular_id country_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c2)) . (id_expression (regular_id country_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c3)) . (id_expression (regular_id country_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id bo)) . (id_expression (regular_id office_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrb)) . (id_expression (regular_id risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id io)) . (id_expression (regular_id office_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rri)) . (id_expression (regular_id risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id legal_ultimate_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) ))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id economic_ultimate_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) ))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i1)) . (id_expression (regular_id industry_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_basic_customer)))))) (table_alias (identifier (id_expression (regular_id b))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_country)))))) (table_alias (identifier (id_expression (regular_id c1))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id country_of_residence)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c1)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_country)))))) (table_alias (identifier (id_expression (regular_id c2))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id country_of_incorporation)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c2)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_country)))))) (table_alias (identifier (id_expression (regular_id c3))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id worst_country_of_risk)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c3)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_segmentation_type)))))) (table_alias (identifier (id_expression (regular_id st))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id segmentation_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_customer_type)))))) (table_alias (identifier (id_expression (regular_id ct))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ct)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rrb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrb)) . (id_expression (regular_id code))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rri))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rri)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_office)))))) (table_alias (identifier (id_expression (regular_id bo))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id bnk_risk_rating_owner)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id bo)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_office)))))) (table_alias (identifier (id_expression (regular_id io))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id ins_risk_rating_owner)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id io)) . (id_expression (regular_id code))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_industry_type)))))) (table_alias (identifier (id_expression (regular_id i1))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id industry1_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i1)) . (id_expression (regular_id code)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_new_der_local))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-8: Add all new LOCAL records to export_derived_customer')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id d) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (table_alias (identifier (id_expression (regular_id d))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id i))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_der_iden))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-9: Add yet unsaved customers to identification table')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) ; (statement (loop_statement while (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) LOOP (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id a))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id g))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id legal_imm_parent_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_child_lookup))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id a))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id g))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id legal_ult_parent_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_child_lookup))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id a))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id g))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id econ_imm_parent_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_child_lookup))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id a))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id g))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id econ_ult_parent_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_child_lookup))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id a))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id legal_imm_parent_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_child_lookup))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id a))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_derived_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id legal_ult_parent_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_child_lookup))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id a))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id econ_imm_parent_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_child_lookup))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id a))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_derived_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id a)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id econ_ult_parent_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id e))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_child_lookup))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) THEN (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-10: Find childs in GRID tree, which are yet unknown in export')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' now of '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' total)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ;) END)) ;) END IF)) ;) END)) ;) END LOOP)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_childs))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id i) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id i))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (table_alias (identifier (id_expression (regular_id d))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id i)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_gen_lookup_tab))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-11: Generate lookup work table')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) , (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id legal_imm_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id legal_ult_parent_id))))) , (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_imm_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id econ_ult_parent_id))))) , (selected_element (select_list_elements (regular_id utils) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id convert_to_number)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 7)))))))))))) ))))))))))))))) (column_alias (identifier (id_expression (regular_id status))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_childs)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_localcust)))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_gen_recalc_tab))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-12: Generate work table for ult parent recalcs')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rating_exclusions))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reference_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id rule_assignment)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rule_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'WITHDRAWN'))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id process_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'R_GRID_RATINGS_EXCLUSION'))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id generated_record)))) , (column_name (identifier (id_expression (regular_id grid_interface)))) , (column_name (identifier (id_expression (regular_id load_key)))) , (column_name (identifier (id_expression (regular_id customer_type_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation_key)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id regulated_indicator)))) , (column_name (identifier (id_expression (regular_id customer_type_cdd_key)))) , (column_name (identifier (id_expression (regular_id customer_type_mifid_key)))) , (column_name (identifier (id_expression (regular_id risk_level_cdd_key)))) , (column_name (identifier (id_expression (regular_id classification_mifid_key)))) , (column_name (identifier (id_expression (regular_id industry1_key)))) , (column_name (identifier (id_expression (regular_id industry2_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_poland_key))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id generated_record))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater))))))))))) IS NOT NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))) NOT IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reference_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rating_exclusions))))))))))))) )))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating)))))))))))))) END)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater))))))))))) IS NOT NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))) NOT IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reference_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rating_exclusions))))))))))))) )))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id risk_rating_key)))))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating_key)))))))))))))) END)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ins_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater))))))))))) IS NOT NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))) NOT IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reference_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rating_exclusions))))))))))))) )))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating)))))))))))))) END)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater))))))))))) IS NOT NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))) NOT IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reference_code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rating_exclusions))))))))))))) )))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id risk_rating_key)))))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating_key)))))))))))))) END)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_type_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_type_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id risk_level_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id classification_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id industry2_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id segmentation_type_poland_key)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id g))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (table_alias (identifier (id_expression (regular_id d))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id b))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id current_risk_rating)))))) (table_alias (identifier (id_expression (regular_id rrrrb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id bnk_risk_rating_risk_rater)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rrrrb)) . (id_expression (regular_id code)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_add_grid_child))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-13: Add GRID child triggered customers to export_derived_customer table')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function count ( * ))))))))))))))) (into_clause into (variable_name (id_expression (regular_id v_temp)))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))))) (where_clause where (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))))))))))) ; (statement (loop_statement WHILE (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_temp)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))))) LOOP (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id tt_recalc)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id tt_recalc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id legal_ultimate_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) ))))))))))))) (column_alias AS (identifier (id_expression (regular_id pos_2))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) (column_alias as (identifier (id_expression (regular_id pos_3))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id legal_ult_parent_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pos_2)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id status))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pos_3))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_calc_legal_ult))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id tt_recalc)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id tt_recalc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) (column_alias as (identifier (id_expression (regular_id pos_1))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id g)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id legal_ult_parent_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id legal_ult_parent_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id status))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pos_1))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_calc_legal_ult))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id tt_recalc)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id tt_recalc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id b) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id legal_imm_parent_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id b)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id legal_ult_parent_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id legal_imm_parent_id))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_calc_legal_ult))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) THEN (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-14: Recalc LEGAL local ultimate parents')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' now of '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' total)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ;) END)) ;) END IF)) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function count ( * ))))))))))))))) (into_clause into (variable_name (id_expression (regular_id v_temp)))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))))) (where_clause where (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))))))))))) ;) END)) ;) END LOOP)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_temp)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function count ( * ))))))))))))))) (into_clause into (variable_name (id_expression (regular_id v_temp)))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))))) (where_clause where (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id status)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))))))))) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_temp)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_final_legal_ult))))) ;) END IF)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_temp)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function count ( * ))))))))))))))) (into_clause into (variable_name (id_expression (regular_id v_temp)))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))))) (where_clause where (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))))))))) ; (statement (loop_statement WHILE (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_temp)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0)))))))))))))) LOOP (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id tt_recalc)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id tt_recalc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id economic_ultimate_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id))))))))))))) ))))))))))))) (column_alias AS (identifier (id_expression (regular_id pos_2))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 2))))))))))))) (column_alias as (identifier (id_expression (regular_id pos_3))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id econ_ult_parent_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pos_2)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id status))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pos_3))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_calc_econ_ult))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id tt_recalc)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id tt_recalc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 2))))))))))))) (column_alias as (identifier (id_expression (regular_id pos_1))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id g)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id econ_ult_parent_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id econ_ult_parent_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id status))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pos_1))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_calc_econ_ult))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id tt_recalc)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id tt_recalc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id b) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_imm_parent_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id b)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_recalc)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id tt_recalc))) . (id_expression (regular_id econ_ult_parent_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id econ_imm_parent_id))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_calc_econ_ult))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc)))))))) + (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) THEN (seq_of_statements (statement (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-15: Recalc ECON local ultimate parents')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' now of '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_crc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' total)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ;) END)) ;) END IF)) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function count ( * ))))))))))))))) (into_clause into (variable_name (id_expression (regular_id v_temp)))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))))) (where_clause where (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id status)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))))))))) ;) END)) ;) END LOOP)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_temp)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function count ( * ))))))))))))))) (into_clause into (variable_name (id_expression (regular_id v_temp)))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))))))) (where_clause where (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id status)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 2)))))))))))))))))))) ; (statement (if_statement IF (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_temp)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_final_econ_ult))))) ;) END IF)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id generated_record)))) , (column_name (identifier (id_expression (regular_id grid_interface)))) , (column_name (identifier (id_expression (regular_id load_key)))) , (column_name (identifier (id_expression (regular_id customer_type_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_residence_key)))) , (column_name (identifier (id_expression (regular_id ctry_of_incorporation_key)))) , (column_name (identifier (id_expression (regular_id worst_ctry_of_risk_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_risk_rater_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_owner_key)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_id)))) , (column_name (identifier (id_expression (regular_id legal_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id legal_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_imm_parent_key)))) , (column_name (identifier (id_expression (regular_id econ_ult_parent_key)))) , (column_name (identifier (id_expression (regular_id bnk_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id ins_risk_rating_source)))) , (column_name (identifier (id_expression (regular_id regulated_indicator)))) , (column_name (identifier (id_expression (regular_id customer_type_cdd_key)))) , (column_name (identifier (id_expression (regular_id customer_type_mifid_key)))) , (column_name (identifier (id_expression (regular_id risk_level_cdd_key)))) , (column_name (identifier (id_expression (regular_id classification_mifid_key)))) , (column_name (identifier (id_expression (regular_id industry1_key)))) , (column_name (identifier (id_expression (regular_id industry2_key)))) , (column_name (identifier (id_expression (regular_id segmentation_type_poland_key))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id generated_record))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ctry_of_residence_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ctry_of_incorporation_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id worst_ctry_of_risk_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id segmentation_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating_risk_rater_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating_owner_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id legal_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id bnk_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id ins_risk_rating_source))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id regulated_indicator))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_type_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_type_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id risk_level_cdd_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id classification_mifid_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id industry1_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id industry2_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id segmentation_type_poland_key)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_derived_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_recalc)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer)))))) (table_alias (identifier (id_expression (regular_id d))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_add_local_child))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-16: Add LOCAL child triggered customers to export_derived_customer table')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id assign_id_ranges)))) (function_argument ( (argument (identifier (id_expression (regular_id p_id_type))) = > (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'CUSTOMER_KEY')))))))))))) , (argument (identifier (id_expression (regular_id p_table_name))) = > (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'export_customer_identification')))))))))))) , (argument (identifier (id_expression (regular_id p_key_column))) = > (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'customer_key_nr')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_assign_ck))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-17: Generate new customer_keys'))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id export_customer_identification)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id export_customer_identification) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id l)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_customer_identification)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_customer_identification)) . (id_expression (regular_id basic_customer_key))))))))))) IS NULL)))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_customer_identification)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id export_customer_identification))) . (id_expression (regular_id basic_customer_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id basic_customer_key))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_upd_iden_local_bck))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-18: Complete info in export_customer_identification (local)')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id export_customer_identification)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id export_customer_identification) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id g)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_customer_identification)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_customer_identification)) . (id_expression (regular_id basic_customer_key))))))))))) IS NULL)))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_customer_identification)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id export_customer_identification))) . (id_expression (regular_id basic_customer_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id basic_customer_key))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_upd_iden_grid_bck))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-18: Complete info in export_customer_identification (grid)')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_extra))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id legal_immediate_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id legal_immediate_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id legal_immediate_parent_id))))))))))) IS NOT NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id legal_ultimate_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id legal_ultimate_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id legal_ultimate_parent_id))))))))))) IS NOT NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL))))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id economic_immediate_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id economic_immediate_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id economic_immediate_parent_id))))))))))) IS NOT NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL))))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id economic_ultimate_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id economic_ultimate_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id economic_ultimate_parent_id))))))))))) IS NOT NULL) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL))))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id vc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id valid_customer)))))) (table_alias (identifier (id_expression (regular_id vc))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vc)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_iden_unchanged))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-19: Identify unchanged parent ids (and all others) for export_customer_identification')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_key_nr)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_extra)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id g))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_add_grid_unchanged))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-20: Add unchanged parents to export_customer_identification')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_key_nr)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_extra)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_derived_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_add_local_unchanged))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-20: Add unchanged parents to export_customer_identification')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_imm))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id b) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id legal_imm_parent_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id b))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id b) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_imm_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id legal_imm_parent_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id b))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id b)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_iden_diff_tree))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-21: Identified all immediate parents from both trees')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_ult))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id d) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id legal_ult_parent_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_derived_customer)))))) (table_alias (identifier (id_expression (regular_id d))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id d) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_ult_parent_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id legal_ult_parent_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id d))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id d)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_iden_diff_tree))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-21: Identified all ultimate parents from both trees')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_full))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_imm_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_imm)))))))))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id legal_imm_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_imm))))))))))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id econ_ult_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_ult))))))))))))) (subquery_operation_part UNION (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id legal_ult_parent_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_ult)))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_iden_diff_tree))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-21: Combined all unique parents from both trees')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id g) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_key_nr)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_full)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_derived_customer)))))) (table_alias (identifier (id_expression (regular_id g))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id g)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_add_grid_unchanged_diff_tree))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-22: Add unchanged parents from both trees to export_customer_identification')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id basic_customer_key)))) , (column_name (identifier (id_expression (regular_id customer_key_nr))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id l) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_key_nr)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_diff_tree_full)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_derived_customer)))))) (table_alias (identifier (id_expression (regular_id l))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id l)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_add_local_unchanged_diff_tree))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-22: Add unchanged parents from both trees to export_customer_identification')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id export_derived_customer)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id export_derived_customer) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias as (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id eci1) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci1)) . (id_expression (regular_id customer_key_nr))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))))) (column_alias as (identifier (id_expression (regular_id is_grid_interface))))) , (selected_element (select_list_elements (regular_id eci2) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_key_nr))))))))))))))) (column_alias as (identifier (id_expression (regular_id legal_imm_parent_key))))) , (selected_element (select_list_elements (regular_id eci3) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_key_nr))))))))))))))) (column_alias as (identifier (id_expression (regular_id legal_ult_parent_key))))) , (selected_element (select_list_elements (regular_id eci4) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_key_nr))))))))))))))) (column_alias as (identifier (id_expression (regular_id econ_imm_parent_key))))) , (selected_element (select_list_elements (regular_id eci5) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_key_nr))))))))))))))) (column_alias as (identifier (id_expression (regular_id econ_ult_parent_key))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci1))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci1)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id grid_basic_customer)))))) (table_alias (identifier (id_expression (regular_id gb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci1)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci2))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id legal_imm_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci2)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci3))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id legal_ult_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci3)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci4))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id gb)) . (id_expression (regular_id econ_imm_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci4)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci5))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id econ_ult_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci5)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id customer_id)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_localcust))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id basic_customer_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id basic_customer_key)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id customer_key_nr))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id customer_key_nr)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id system_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id grid_interface))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id is_grid_interface)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id load_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_load_key)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id legal_imm_parent_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id legal_imm_parent_key)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id legal_ult_parent_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id legal_ult_parent_key)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id econ_imm_parent_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id econ_imm_parent_key)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id econ_ult_parent_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id econ_ult_parent_key))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_grid_export))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-23: Complete info in export_derived_customer (grid)')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id export_derived_customer)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id export_derived_customer) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id eci1) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id basic_customer_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci1)) . (id_expression (regular_id customer_key_nr))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N'))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci2)) . (id_expression (regular_id customer_key_nr))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci6)) . (id_expression (regular_id customer_key_nr))))))))))))) ))))))))))))) (column_alias AS (identifier (id_expression (regular_id pos_7))))) , (selected_element (select_list_elements (regular_id eci3) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_key_nr))))))))))))))) (column_alias as (identifier (id_expression (regular_id legal_ult_parent_key))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci4)) . (id_expression (regular_id customer_key_nr))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci7)) . (id_expression (regular_id customer_key_nr))))))))))))) ))))))))))))) (column_alias AS (identifier (id_expression (regular_id pos_9))))) , (selected_element (select_list_elements (regular_id eci5) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_key_nr))))))))))))))) (column_alias as (identifier (id_expression (regular_id econ_ult_parent_key))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_derived_customer))))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci1))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci1)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_basic_customer)))))) (table_alias (identifier (id_expression (regular_id eb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci1)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eb)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci2))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eb)) . (id_expression (regular_id legal_imm_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci2)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci3))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id legal_ult_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci3)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci4))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eb)) . (id_expression (regular_id econ_imm_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci4)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci5))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id econ_ult_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci5)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id local_basic_customer)))))) (table_alias (identifier (id_expression (regular_id lb))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci1)) . (id_expression (regular_id customer_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id lb)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci6))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id lb)) . (id_expression (regular_id legal_imm_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci6)) . (id_expression (regular_id customer_id))))))))))))))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_customer_identification)))))) (table_alias (identifier (id_expression (regular_id eci7))))) (join_on_part ON (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id lb)) . (id_expression (regular_id econ_imm_parent_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id eci7)) . (id_expression (regular_id customer_id)))))))))))))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id customer_id)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_localcust))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_derived_customer)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id basic_customer_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id basic_customer_key)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id customer_key_nr))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id customer_key_nr)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id system_id))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id grid_interface))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'N')))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id load_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_load_key)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id legal_imm_parent_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pos_7)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id legal_ult_parent_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id legal_ult_parent_key)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id econ_imm_parent_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id pos_9)))))))))))))) , (merge_element (column_name (identifier (id_expression (regular_id export_derived_customer))) . (id_expression (regular_id econ_ult_parent_key))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id econ_ult_parent_key))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (raise_statement RAISE (exception_name (identifier (id_expression (regular_id exception_util))) . (id_expression (regular_id err_save_local_export))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount)))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-23: Complete info in export_derived_customer (local)')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'end')))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\changed_customers.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id changed_customers)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_reporting_date ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id dsa_reporting_date ) ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_rc ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_crc ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_localcust ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 10 ) , ( numeric 0 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_load_key ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_txt ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 255 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_temp ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) , ( numeric 0 ) ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_procname ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id procedure_name ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_localcust ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 99999999 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id load_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_load_key ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id dsa_dwh_synchronisation ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reporting_date ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_load_key ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'export_basic_customer' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_clear ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'export_derived_customer' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_clear ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'export_customer_identification' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_clear ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-0: Finished clearing export tables' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_basic_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_name ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id city ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id metropolitan_area_name ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id influenced_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id standalone_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id relationship_start_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id branch_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id active_status ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id active_status_detail ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id source_system ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exists_as_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c alias ) ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id building_name ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id street_name ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id postcode ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_in_12c state ) ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id total_assets ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id total_liabilities ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id net_sales ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id net_income ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id total_equity ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id statement_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id currency_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id reference_limit ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id reference_limit_ccy ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id eurogate ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id graydon_z_score ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id graydon_g_score ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id next_review_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id parent_account_manager ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_account_manager ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id primary_risk_manager ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id distribution_channel ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id town_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_code ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 10 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '' ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_name ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_type ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 10 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_type ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id city ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 40 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id city ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id city_code ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 60 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id metropolitan_area_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id country_of_residence ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ctry_of_residence ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id country_of_incorporation ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ctry_of_incorporation ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id worst_country_of_risk ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id worst_ctry_of_risk ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id segmentation_code ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 10 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id segmentation_code ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id legal_immediate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 10 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id economic_immediate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 10 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id influenced_risk_rating ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 6 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id influenced_risk_rating ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id standalone_risk_rating ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 6 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id standalone_risk_rating ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id relationship_start_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id relationship_start_date ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 10 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id bnk_risk_rating_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id bnk_risk_rating_date ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 10 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ins_risk_rating_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ins_risk_rating_date ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id branch_indicator ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id branch_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id active_status ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id active_status ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id active_status_detail ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id active_status_detail ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id source_system ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id source_system ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id exists_as_id ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 10 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id exists_as_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c alias ) ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c alias ) ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id building_name ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id building_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id street_name ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id street_name ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id postcode ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id postcode ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ( non_reserved_keywords_in_12c state ) ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 100 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ( non_reserved_keywords_in_12c state ) ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id total_assets ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 22 ) , ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id total_assets ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id total_liabilities ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 22 ) , ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id total_liabilities ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id net_sales ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 22 ) , ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id net_sales ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id net_income ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 22 ) , ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id net_income ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id total_equity ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 22 ) , ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id total_equity ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id statement_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id statement_date ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id currency_code ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id currency_code ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id reference_limit ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 22 ) , ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id reference_limit ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id reference_limit_ccy ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id reference_limit_ccy ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id eurogate ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id eurogate ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id graydon_z_score ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id graydon_z_score ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id graydon_g_score ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 3 ) , ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id graydon_g_score ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id next_review_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id next_review_date ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id parent_account_manager ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id parent_account_manager ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id local_account_manager ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id local_account_manager ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id primary_risk_manager ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id primary_risk_manager ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id distribution_channel ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id distribution_channel ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id town_code ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id town_code ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id industry1_code ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 10 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id industry1_code ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_localcust ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_gen_basic ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-1: Generate all basic data from valid_customer for local customer_ids' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_basic_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_name ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id city ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id metropolitan_area_name ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id influenced_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id standalone_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id relationship_start_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id branch_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id active_status ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id active_status_detail ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id source_system ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id exists_as_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c alias ) ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id internal_building_reference ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id building_name ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id street_name ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id postcode ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_in_12c state ) ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id total_assets ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id total_liabilities ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id net_sales ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id net_income ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id total_equity ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id statement_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id currency_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id reference_limit ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id reference_limit_ccy ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id eurogate ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id graydon_z_score ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id graydon_g_score ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id next_review_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id parent_account_manager ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_account_manager ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id relationship_manager ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id primary_risk_manager ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id distribution_channel ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id town_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id maintenance_unit_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id maintenance_unit ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_cdd_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_mifid_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_scs_dept_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_review_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id approved_signatory_cdd ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id date_completed_cdd ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id cdd_scs_dept_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id review_date_cdd ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id mifid_scs_dept_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id review_date_mifid ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id last_updated ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id mifid_approval_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id foundation_date ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_status ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry2_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id risk_level_cdd_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id classification_mifid_code ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id cust_segm_pl_code ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id t ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id city ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id metropolitan_area_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_residence ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_incorporation ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id worst_ctry_of_risk ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id influenced_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id standalone_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id relationship_start_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id branch_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id active_status ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id active_status_detail ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id source_system ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id exists_as_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c alias ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id building_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id street_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id postcode ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ( non_reserved_keywords_in_12c state ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id total_assets ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id total_liabilities ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id net_sales ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id net_income ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id total_equity ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id statement_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id currency_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id reference_limit ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id reference_limit_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id eurogate ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id graydon_z_score ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id graydon_g_score ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id next_review_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id parent_account_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id local_account_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id primary_risk_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id distribution_channel ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id town_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry1_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id city ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id city ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id metropolitan_area_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id metropolitan_area_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_residence ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id ctry_of_residence ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_incorporation ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id ctry_of_incorporation ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id worst_ctry_of_risk ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id worst_ctry_of_risk ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id segmentation_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id influenced_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id influenced_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id standalone_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id standalone_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id relationship_start_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id relationship_start_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id ins_risk_rating_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id branch_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id branch_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id active_status ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id active_status ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id active_status_detail ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id active_status_detail ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id source_system ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id source_system ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id exists_as_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id exists_as_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c alias ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c alias ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id building_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id building_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id street_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id street_name ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id postcode ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id postcode ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ( non_reserved_keywords_in_12c state ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id ( non_reserved_keywords_in_12c state ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id total_assets ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id total_assets ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id total_liabilities ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id total_liabilities ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id net_sales ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id net_sales ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id net_income ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id net_income ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id total_equity ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id total_equity ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id statement_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id statement_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id currency_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id currency_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id reference_limit ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id reference_limit ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id reference_limit_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id reference_limit_ccy ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id eurogate ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id eurogate ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id graydon_z_score ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id graydon_z_score ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id graydon_g_score ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id graydon_g_score ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id next_review_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id next_review_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '01-01-1900' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id parent_account_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id parent_account_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id local_account_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id local_account_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id primary_risk_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id primary_risk_manager ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id distribution_channel ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id distribution_channel ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id town_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id town_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry1_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id industry1_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement raise ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-2: Add all new and changed records to export_basic_customer' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_basic_customer ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_basic_iden ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-3: Add customer_ids to identification table' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id assign_id_ranges ) ) ) ) ( function_argument ( ( argument ( identifier ( id_expression ( regular_id p_id_type ) ) ) = > ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'BASIC_CUSTOMER_KEY' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( identifier ( id_expression ( regular_id p_table_name ) ) ) = > ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'export_customer_identification' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( identifier ( id_expression ( regular_id p_key_column ) ) ) = > ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'basic_customer_key' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_gen_basic_ck ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id export_basic_customer ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id export_basic_customer ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id export_customer_identification ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_basic_customer ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_customer_identification ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_basic_customer ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_basic_customer ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_basic_customer ) ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_basic_ck ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-4: Assign new basic_customer_keys' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function COUNT ( ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_rc ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_basic_iden ) ) ) ) ) ; ) END IF ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_derived_customer' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_derived_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id generated_record ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id grid_interface ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id load_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id regulated_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id classification_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry2_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 10 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element DATE ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element DATE ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id system_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id generated_record ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id generated_record ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id grid_interface ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id load_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ct ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_type_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c1 ) ) . ( id_expression ( regular_id country_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c2 ) ) . ( id_expression ( regular_id country_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c3 ) ) . ( id_expression ( regular_id country_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id bo ) ) . ( id_expression ( regular_id office_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 6 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrb ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrri ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id io ) ) . ( id_expression ( regular_id office_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 6 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rri ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id legal_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 10 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id economic_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 10 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 18 ) , ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id regulated_indicator ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cdd ) ) . ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mifid ) ) . ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rl ) ) . ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cm ) ) . ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i1 ) ) . ( id_expression ( regular_id industry_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ix ) ) . ( id_expression ( regular_id industry_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id industry1_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i2 ) ) . ( id_expression ( regular_id industry_type_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id industry2_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function CAST ( ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pl ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) AS ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_country ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c1 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id country_of_residence ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c1 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_country ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c2 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id country_of_incorporation ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c2 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_country ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c3 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id worst_country_of_risk ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c3 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_segmentation_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id segmentation_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_customer_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ct ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ct ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rrb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrb ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rri ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rri ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_office ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id bo ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id bo ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_office ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id io ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id io ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id gb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rrrrb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rrrri ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id ins_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrri ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_customer_type_cdd ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id cdd ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id customer_type_cdd_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cdd ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_customer_type_mifid ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id mifid ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id customer_type_mifid_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id mifid ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_level_cdd ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rl ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id risk_level_cdd_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rl ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_classification_mifid ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id cm ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id classification_mifid_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id cm ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_industry_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id i1 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id industry1_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i1 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_industry_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id i2 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id industry2_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i2 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_industry_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ix ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id industry1_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ix ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_cust_segm_pl ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id pl ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id cust_segm_pl_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pl ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_gen_derived ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-5: Generate all derived data from valid_customer for all customer_ids' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id generated_record ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id grid_interface ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id load_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id regulated_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id classification_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry2_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id t ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id generated_record ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id grid_interface ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id load_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry2_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id gb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rrrrb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry2_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id industry2_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_der_grid ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-6: Add all changed GRID records to export_derived_customer' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id generated_record ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id grid_interface ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id load_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id regulated_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id classification_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry2_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id t ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id generated_record ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id grid_interface ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id load_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry2_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rrrrb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_der_grid_basic_key ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-6.2: Add all changed basic GRID records to export_derived_customer' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id generated_record ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id grid_interface ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id load_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id regulated_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id classification_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry2_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id t ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id generated_record ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id grid_interface ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id load_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry2_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_der_local ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-7: Add all changed LOCAL records to export_derived_customer' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id generated_record ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id grid_interface ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id load_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id regulated_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id classification_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry2_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id generated_record ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ct ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c1 ) ) . ( id_expression ( regular_id country_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c2 ) ) . ( id_expression ( regular_id country_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c3 ) ) . ( id_expression ( regular_id country_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id bo ) ) . ( id_expression ( regular_id office_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrb ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id io ) ) . ( id_expression ( regular_id office_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rri ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id legal_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id economic_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i1 ) ) . ( id_expression ( regular_id industry_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_country ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c1 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id country_of_residence ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c1 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_country ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c2 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id country_of_incorporation ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c2 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_country ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c3 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id worst_country_of_risk ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c3 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_segmentation_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id segmentation_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_customer_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ct ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ct ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rrb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrb ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rri ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rri ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_office ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id bo ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id bnk_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id bo ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_office ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id io ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id ins_risk_rating_owner ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id io ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_industry_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id i1 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id industry1_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i1 ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_new_der_local ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-8: Add all new LOCAL records to export_derived_customer' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id d ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id i ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_der_iden ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-9: Add yet unsaved customers to identification table' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( loop_statement while ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) LOOP ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_child_lookup ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_child_lookup ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_child_lookup ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_child_lookup ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_child_lookup ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_child_lookup ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_child_lookup ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id a ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id a ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_child_lookup ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-10: Find childs in GRID tree, which are yet unknown in export' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' now of ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' total)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) END IF ) ) ; ) END ) ) ; ) END LOOP ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_childs ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id i ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id i ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id i ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_gen_lookup_tab ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-11: Generate lookup work table' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id utils ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id convert_to_number ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 7 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id status ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_childs ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_localcust ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_gen_recalc_tab ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-12: Generate work table for ult parent recalcs' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rating_exclusions ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reference_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id rule_assignment ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rule_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'WITHDRAWN' ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id process_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'R_GRID_RATINGS_EXCLUSION' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id generated_record ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id grid_interface ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id load_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id regulated_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id classification_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry2_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id generated_record ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) NOT IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reference_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rating_exclusions ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) ) END ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) NOT IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reference_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rating_exclusions ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) END ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) NOT IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reference_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rating_exclusions ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) ) END ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) NOT IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reference_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rating_exclusions ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) END ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id industry2_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id current_risk_rating ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rrrrb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rrrrb ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_add_grid_child ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-13: Add GRID child triggered customers to export_derived_customer table' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function count ( * ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause into ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( loop_statement WHILE ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) LOOP ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id tt_recalc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id legal_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias AS ( identifier ( id_expression ( regular_id pos_2 ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id pos_3 ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pos_2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id status ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pos_3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_calc_legal_ult ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id tt_recalc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id pos_1 ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id status ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pos_1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_calc_legal_ult ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id tt_recalc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id b ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_calc_legal_ult ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-14: Recalc LEGAL local ultimate parents' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' now of ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' total)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) END IF ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function count ( * ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause into ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) END LOOP ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function count ( * ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause into ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_final_legal_ult ) ) ) ) ) ; ) END IF ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function count ( * ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause into ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( loop_statement WHILE ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ) LOOP ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id tt_recalc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id economic_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias AS ( identifier ( id_expression ( regular_id pos_2 ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id pos_3 ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pos_2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id status ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pos_3 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_calc_econ_ult ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id tt_recalc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id pos_1 ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id status ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pos_1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_calc_econ_ult ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id tt_recalc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id b ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_recalc ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_calc_econ_ult ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) + ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-15: Recalc ECON local ultimate parents' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' now of ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' total)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) END IF ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function count ( * ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause into ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) END ) ) ; ) END LOOP ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function count ( * ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause into ( variable_name ( id_expression ( regular_id v_temp ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id status ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( if_statement IF ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_temp ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_final_econ_ult ) ) ) ) ) ; ) END IF ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id generated_record ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id grid_interface ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id load_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id regulated_indicator ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id classification_mifid_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry1_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id industry2_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id generated_record ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ctry_of_residence_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ctry_of_incorporation_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id worst_ctry_of_risk_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id segmentation_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating_risk_rater_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating_owner_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id bnk_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id ins_risk_rating_source ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id regulated_indicator ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_type_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_type_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id risk_level_cdd_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id classification_mifid_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id industry1_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id industry2_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id segmentation_type_poland_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_recalc ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_add_local_child ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-16: Add LOCAL child triggered customers to export_derived_customer table' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id assign_id_ranges ) ) ) ) ( function_argument ( ( argument ( identifier ( id_expression ( regular_id p_id_type ) ) ) = > ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'CUSTOMER_KEY' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( identifier ( id_expression ( regular_id p_table_name ) ) ) = > ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'export_customer_identification' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( identifier ( id_expression ( regular_id p_key_column ) ) ) = > ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'customer_key_nr' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_assign_ck ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-17: Generate new customer_keys' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id export_customer_identification ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_customer_identification ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_customer_identification ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_customer_identification ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_upd_iden_local_bck ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-18: Complete info in export_customer_identification (local)' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id export_customer_identification ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_customer_identification ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_customer_identification ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_customer_identification ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_upd_iden_grid_bck ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-18: Complete info in export_customer_identification (grid)' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_extra ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id legal_immediate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id legal_immediate_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id legal_immediate_parent_id ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id legal_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id legal_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id legal_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id economic_immediate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id economic_immediate_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id economic_immediate_parent_id ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id economic_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id economic_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id economic_ultimate_parent_id ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id vc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id valid_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id vc ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vc ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_iden_unchanged ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-19: Identify unchanged parent ids (and all others) for export_customer_identification' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_extra ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_add_grid_unchanged ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-20: Add unchanged parents to export_customer_identification' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_extra ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_add_local_unchanged ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-20: Add unchanged parents to export_customer_identification' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_imm ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id b ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id b ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id b ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id b ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_iden_diff_tree ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-21: Identified all immediate parents from both trees' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_ult ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id d ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id d ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id d ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id d ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_iden_diff_tree ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-21: Identified all ultimate parents from both trees' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_full ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_imm ) ) ) ) ) ) ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_imm ) ) ) ) ) ) ) ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_ult ) ) ) ) ) ) ) ) ) ) ) ) ) ( subquery_operation_part UNION ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_ult ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_iden_diff_tree ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-21: Combined all unique parents from both trees' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id g ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_full ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id g ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id g ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_add_grid_unchanged_diff_tree ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-22: Add unchanged parents from both trees to export_customer_identification' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id basic_customer_key ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id l ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_diff_tree_full ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_derived_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id l ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id l ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_add_local_unchanged_diff_tree ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-22: Add unchanged parents from both trees to export_customer_identification' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id export_derived_customer ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id eci1 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci1 ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id is_grid_interface ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id eci2 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id eci3 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id eci4 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id eci5 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci1 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci1 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id grid_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id gb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci1 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci2 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci2 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci3 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci3 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci4 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id gb ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci4 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci5 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci5 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_localcust ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id system_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id grid_interface ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id is_grid_interface ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id load_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_load_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id legal_imm_parent_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id legal_imm_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id legal_ult_parent_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id econ_imm_parent_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id econ_imm_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id econ_ult_parent_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_grid_export ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-23: Complete info in export_derived_customer (grid)' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id export_derived_customer ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id eci1 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci1 ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci2 ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci6 ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias AS ( identifier ( id_expression ( regular_id pos_7 ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id eci3 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci4 ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci7 ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias AS ( identifier ( id_expression ( regular_id pos_9 ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id eci5 ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci1 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci1 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci1 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eb ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci2 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eb ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci2 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci3 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id legal_ult_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci3 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci4 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eb ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci4 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci5 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id econ_ult_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci5 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id local_basic_customer ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id lb ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci1 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id lb ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci6 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id lb ) ) . ( id_expression ( regular_id legal_imm_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci6 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_customer_identification ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id eci7 ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id lb ) ) . ( id_expression ( regular_id econ_imm_parent_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id eci7 ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_localcust ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_derived_customer ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id basic_customer_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id customer_key_nr ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id system_id ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id grid_interface ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'N' ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id load_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_load_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id legal_imm_parent_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pos_7 ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id legal_ult_parent_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id legal_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id econ_imm_parent_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id pos_9 ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_derived_customer ) ) ) . ( id_expression ( regular_id econ_ult_parent_key ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id econ_ult_parent_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( raise_statement RAISE ( exception_name ( identifier ( id_expression ( regular_id exception_util ) ) ) . ( id_expression ( regular_id err_save_local_export ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-23: Complete info in export_derived_customer (local)' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'end' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
D:\projects\plsqlcode\changed_ri_match.sql
(sql_script (unit_statement (create_procedure_body CREATE OR REPLACE PROCEDURE (procedure_name (identifier (id_expression (regular_id changed_ri_match)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id system_id))))) , (parameter (parameter_name (identifier (id_expression (regular_id v_reporting_date)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id general_date))))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_rc))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_crc))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_err))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_ret))) (type_spec (datatype (native_datatype_element NUMBER) (precision_part ( (numeric 12) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_txt))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 255) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_errmsg))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 255) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_proc_name))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id procname)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_debug_msg))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id debug_msg)))) ;))) (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_proc_name)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_rc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_crc)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 0))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_err)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_ret)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_errmsg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'export_ri_match_facility')))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'export_ri_match_outstanding')))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-0: Finished clearing export tables'))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_change_rrmf')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_change_rrmf')))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_change_rrmf))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id n) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until))))))))))))))) (column_alias (identifier (id_expression (regular_id old_record_valid_until))))) , (selected_element (select_list_elements (regular_id n) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id customer_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id n))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id o))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id facility_id))))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL)))) )))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) ))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_customer_id))))))))))) IS NULL) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id local_customer_id))))))))))) IS NULL)))) ))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c coalesce))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_customer_id)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id local_customer_id)))))))))))))) ))))))))))) IS NOT NULL)))) )))))))))))) ))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) ))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id customer_id))))))))))) IS NULL) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))) ))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c coalesce))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id customer_id)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id customer_id)))))))))))))) ))))))))))) IS NOT NULL)))) )))))))))))) )))))))))))) ))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF tt_change_rrmf'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-1: Created #changed_rrmf')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_facility)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id facility_id)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id customer_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))))) (column_alias (identifier (id_expression (regular_id facility_id))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id system_id))))))))))))))) (column_alias (identifier (id_expression (regular_id system_id))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id record_valid_from))))))))))))))) (column_alias (identifier (id_expression (regular_id record_valid_from))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))))) (column_alias (identifier (id_expression (regular_id record_valid_until))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_customer_id))))))))))))))) (column_alias (identifier (id_expression (regular_id local_customer_id))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id o))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_change_rrmf)))))) (table_alias (identifier (id_expression (regular_id c))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id system_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator <) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id old_record_valid_until))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) )))))))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF export_ri_match_facility'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-2: Add closing old records to export_ri_match_facility')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_facility)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id facility_id)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id customer_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id customer_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id o))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id n))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id system_id))))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL)))) )))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id facility_id))))))))))) IS NULL))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF export_ri_match_facility'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-3: Add closing old records to export_ri_match_facility')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_facility)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id facility_id)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id customer_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id c) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id old_record_valid_until))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id customer_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_change_rrmf)))))) (table_alias (identifier (id_expression (regular_id c))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF export_ri_match_facility'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-4: Add new changed records to export_ri_match_facility')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_facility)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id facility_id)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id customer_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id w) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id customer_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id w)))))))) (where_clause WHERE (expression (logical_expression (logical_expression NOT (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id o)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id system_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL)))) ))))))))))))))) )))))))))) AND (logical_expression NOT (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id e)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id system_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL)))) ))))))))))))))) )))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF export_ri_match_facility'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-5: Add new records to export_ri_match_facility')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_rr_fac_next')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rr_fac_next))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id r) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (over_clause_keyword MIN) (function_argument_analytic ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r)) . (id_expression (regular_id record_valid_from)))))))))))))) )))))))))))))) (column_alias (identifier (id_expression (regular_id next_rvf))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_facility)))))) (table_alias (identifier (id_expression (regular_id r)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r)) . (id_expression (regular_id facility_id)))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF tt_rr_fac_next'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id export_ri_match_facility)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id export_ri_match_facility) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id next_rvf)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_facility)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rr_fac_next)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_ri_match_facility)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_rr_fac_next)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_ri_match_facility)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_ri_match_facility)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_ri_match_facility)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id export_ri_match_facility))) . (id_expression (regular_id record_valid_until))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id next_rvf))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF after merge export_ri_match_facility'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-6: Close current rep_date rvu facility')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_change_rrmo')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_change_rrmo))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id n) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until))))))))))))))) (column_alias (identifier (id_expression (regular_id old_record_valid_until))))) , (selected_element (select_list_elements (regular_id n) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id n))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id o))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id local_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_outstanding_id))))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL)))) )))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) ))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_customer_id))))))))))) IS NULL) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id local_customer_id))))))))))) IS NULL)))) ))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c coalesce))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_customer_id)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id local_customer_id)))))))))))))) ))))))))))) IS NOT NULL)))) )))))))))))) ))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression - (unary_expression (atom (constant (numeric 1)))))))))))) ))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id customer_id))))))))))) IS NULL) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id customer_id))))))))))) IS NULL)))) ))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c coalesce))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id customer_id)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id customer_id)))))))))))))) ))))))))))) IS NOT NULL)))) )))))))))))) )))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) )))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' '))))))))))) ))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id facility_id))))))))))) IS NULL) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id facility_id))))))))))) IS NULL)))) ))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c coalesce))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id facility_id)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id facility_id)))))))))))))) ))))))))))) IS NOT NULL)))) )))))))))))) )))))))))))) ))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF  tt_change_rrmo'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-7: Created #changed_rrmo')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_outstanding)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id local_outstanding_id)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id facility_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_outstanding_id))))))))))))))) (column_alias (identifier (id_expression (regular_id local_outstanding_id))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id system_id))))))))))))))) (column_alias (identifier (id_expression (regular_id system_id))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id record_valid_from))))))))))))))) (column_alias (identifier (id_expression (regular_id record_valid_from))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))))) (column_alias (identifier (id_expression (regular_id record_valid_until))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_customer_id))))))))))))))) (column_alias (identifier (id_expression (regular_id local_customer_id))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id customer_id))))))))))))))) (column_alias (identifier (id_expression (regular_id customer_id))))) , (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))))) (column_alias (identifier (id_expression (regular_id facility_id))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id o))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_change_rrmo)))))) (table_alias (identifier (id_expression (regular_id c))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id local_outstanding_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id system_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator <) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (string_function nvl ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id old_record_valid_until))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) )))))))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF  export_ri_match_outstanding'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-8: Add closing old records to export_ri_match_outstanding')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_outstanding)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id local_outstanding_id)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id facility_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id o) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id o))))) (join_clause (outer_join_type LEFT) JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id n))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id local_outstanding_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id system_id))))))))))))))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL)))) )))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id n)) . (id_expression (regular_id facility_id))))))))))) IS NULL))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF  export_ri_match_outstanding'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-9: Add closing old records to export_ri_match_outstanding')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_outstanding)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id local_outstanding_id)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id facility_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id c) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id old_record_valid_until))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id c)) . (id_expression (regular_id facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_change_rrmo)))))) (table_alias (identifier (id_expression (regular_id c))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF  export_ri_match_outstanding'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-10: Add new changed records to export_ri_match_outstanding')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_outstanding)))))) (paren_column_list ( (column_list (column_name (identifier (id_expression (regular_id local_outstanding_id)))) , (column_name (identifier (id_expression (regular_id system_id)))) , (column_name (identifier (id_expression (regular_id record_valid_from)))) , (column_name (identifier (id_expression (regular_id record_valid_until)))) , (column_name (identifier (id_expression (regular_id local_customer_id)))) , (column_name (identifier (id_expression (regular_id customer_id)))) , (column_name (identifier (id_expression (regular_id facility_id))))) ))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id w) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id system_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant NULL)))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id local_customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id customer_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id w)))))))) (where_clause WHERE (expression (logical_expression (logical_expression NOT (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id o)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id local_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id local_outstanding_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id system_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id o)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL)))) ))))))))))))))) )))))))))) AND (logical_expression NOT (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression EXISTS ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id e)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id local_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id local_outstanding_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id w)) . (id_expression (regular_id system_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))) OR (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id e)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL)))) ))))))))))))))) )))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF  export_ri_match_outstanding'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-11: Add new records to export_ri_match_outstanding')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_rr_out_next')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rr_out_next))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id r) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id local_outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (other_function (over_clause_keyword MIN) (function_argument_analytic ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r)) . (id_expression (regular_id record_valid_from)))))))))))))) )))))))))))))) (column_alias (identifier (id_expression (regular_id next_rvf))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id ri_match_outstanding)))))) (table_alias (identifier (id_expression (regular_id r)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id r)) . (id_expression (regular_id local_outstanding_id)))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT OF  tt_rr_out_next'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id export_ri_match_outstanding)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id export_ri_match_outstanding) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id next_rvf)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id export_ri_match_outstanding)))))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rr_out_next)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_ri_match_outstanding)) . (id_expression (regular_id local_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id tt_rr_out_next)) . (id_expression (regular_id local_outstanding_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_ri_match_outstanding)) . (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_ri_match_outstanding)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id export_ri_match_outstanding)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id export_ri_match_outstanding))) . (id_expression (regular_id record_valid_until))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id next_rvf))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OF PLSQL UNIT'))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '     '))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string '  COUNT of after merge  export_ri_match_outstanding'))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_txt)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'STEP-12: Close current rep_date rvu outstanding')))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ('))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_varchar2)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_rc)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 30)))))))))))) ))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows)')))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_proc_name)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'info')))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_txt)))))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\changed_ri_match.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body CREATE OR REPLACE PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id changed_ri_match)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_reporting_date ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id general_date ) ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_rc ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_crc ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_err ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_ret ) ) ) ( type_spec ( datatype ( native_datatype_element NUMBER ) ( precision_part ( ( numeric 12 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_txt ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 255 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_errmsg ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 255 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_proc_name ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id procname ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_debug_msg ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id debug_msg ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_crc ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 0 ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_err ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_ret ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_errmsg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'export_ri_match_facility' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'export_ri_match_outstanding' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-0: Finished clearing export tables' ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_change_rrmf' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_change_rrmf' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_change_rrmf ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id n ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id old_record_valid_until ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id n ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id n ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c coalesce ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c coalesce ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF tt_change_rrmf' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-1: Created #changed_rrmf' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_facility ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id facility_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id system_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_change_rrmf ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id old_record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF export_ri_match_facility' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-2: Add closing old records to export_ri_match_facility' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_facility ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id n ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF export_ri_match_facility' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-3: Add closing old records to export_ri_match_facility' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_facility ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id c ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id old_record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_change_rrmf ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF export_ri_match_facility' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-4: Add new changed records to export_ri_match_facility' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_facility ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id w ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id w ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression NOT ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression NOT ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF export_ri_match_facility' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-5: Add new records to export_ri_match_facility' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_rr_fac_next' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rr_fac_next ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id r ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( over_clause_keyword MIN ) ( function_argument_analytic ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id next_rvf ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id r ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF tt_rr_fac_next' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_facility ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id export_ri_match_facility ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id next_rvf ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_facility ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rr_fac_next ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_ri_match_facility ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_rr_fac_next ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_ri_match_facility ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_ri_match_facility ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_ri_match_facility ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_ri_match_facility ) ) ) . ( id_expression ( regular_id record_valid_until ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id next_rvf ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF after merge export_ri_match_facility' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-6: Close current rep_date rvu facility' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_change_rrmo' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_change_rrmo ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id n ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id old_record_valid_until ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id n ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id n ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c coalesce ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression - ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c coalesce ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c coalesce ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) IS NOT NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF  tt_change_rrmo' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-7: Created #changed_rrmo' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_outstanding ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id local_outstanding_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id system_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id customer_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id facility_id ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_change_rrmo ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( string_function nvl ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id old_record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF  export_ri_match_outstanding' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-8: Add closing old records to export_ri_match_outstanding' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_outstanding ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id local_outstanding_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id o ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ( join_clause ( outer_join_type LEFT ) JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id n ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id n ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF  export_ri_match_outstanding' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-9: Add closing old records to export_ri_match_outstanding' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_outstanding ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id local_outstanding_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id c ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id old_record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id c ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_change_rrmo ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id c ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF  export_ri_match_outstanding' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-10: Add new changed records to export_ri_match_outstanding' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_outstanding ) ) ) ) ) ) ( paren_column_list ( ( column_list ( column_name ( identifier ( id_expression ( regular_id local_outstanding_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id system_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_from ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id record_valid_until ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id local_customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id customer_id ) ) ) ) , ( column_name ( identifier ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id w ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant NULL ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id local_customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id customer_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id w ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression NOT ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id o ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id o ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression NOT ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression EXISTS ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id e ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id w ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) OR ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id e ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF  export_ri_match_outstanding' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-11: Add new records to export_ri_match_outstanding' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_rr_out_next' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rr_out_next ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id r ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( over_clause_keyword MIN ) ( function_argument_analytic ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id next_rvf ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id ri_match_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id r ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id r ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT OF  tt_rr_out_next' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_outstanding ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id export_ri_match_outstanding ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id next_rvf ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id export_ri_match_outstanding ) ) ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rr_out_next ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_ri_match_outstanding ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id tt_rr_out_next ) ) . ( id_expression ( regular_id local_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_ri_match_outstanding ) ) . ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_ri_match_outstanding ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id export_ri_match_outstanding ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id export_ri_match_outstanding ) ) ) . ( id_expression ( regular_id record_valid_until ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id next_rvf ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OF PLSQL UNIT' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '     ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '  COUNT of after merge  export_ri_match_outstanding' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'STEP-12: Close current rep_date rvu outstanding' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' (' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_varchar2 ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_rc ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 30 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows)' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_proc_name ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'info' ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_txt ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
D:\projects\plsqlcode\change_timebands.sql
(sql_script (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier (id_expression (regular_id change_timebands)))) ( (parameter (parameter_name (identifier (id_expression (regular_id v_system_id)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id systemid))))) , (parameter (parameter_name (identifier (id_expression (regular_id v_reporting_date)))) IN (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id reportingdate))))) ) AS (seq_of_declare_specs (declare_spec (variable_declaration (identifier (id_expression (regular_id v_starters_package_version))) (type_spec (datatype (native_datatype_element VARCHAR2) (precision_part ( (numeric 10) )))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_procname))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id procname)))) (default_value_part := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'change_timebands')))))))))))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_msg))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id debug_msg)))) ;)) (declare_spec (variable_declaration (identifier (id_expression (regular_id v_debug_msg))) (type_spec (type_name (id_expression (regular_id pkg_subtype)) . (id_expression (regular_id debug_msg)))) ;))) (body BEGIN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'START OF PLSQL UNIT ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'start')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id starters_package_version)))))))))))))))) (into_clause INTO (variable_name (id_expression (regular_id v_starters_package_version)))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id reporting_date_system_id)))))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id system_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_system_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id reporting_date)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id no_data_found)))) THEN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_starters_package_version)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant null)))))))))))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' value for v_starters_package_version '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_starters_package_version)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' OF PLSQL UNIT '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_facility_types')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_facility_types))))))) (select_statement (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id ft) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_type_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id record_valid_from))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id record_valid_until))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (case_statement (searched_case_statement CASE (searched_case_when_part WHEN (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_starters_package_version)))))))))) (relational_operator !=) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '2.2'))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'ST'))))))))))))) THEN (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function MAX ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vortex_timeband))))))))))))) ))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id risk_categories)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id risk_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code)))))))))))))))))) ))))))))))) (case_else_part ELSE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function MAX ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id delivered_timeband))))))))))))) ))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id risk_categories)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id risk_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code)))))))))))))))))) ))))))))))) END (label_name (id_expression (regular_id max_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id risk_categories)))))) (table_alias (identifier (id_expression (regular_id rc)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id facility_type)))))) (table_alias (identifier (id_expression (regular_id ft)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id record_valid_from)))))))))) (relational_operator < =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id level_number)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1)))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom ( (expressions (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL) OR (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id record_valid_until)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_reporting_date)))))))))))))))) ))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_facility_types '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' OF PLSQL UNIT '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_stfacs')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id fts) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id risk_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id max_timeband))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id code)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id facility_type)))))) (table_alias (identifier (id_expression (regular_id ft)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_facility_types)))))) (table_alias (identifier (id_expression (regular_id fts)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id highest_level_key)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id facility_type_key))))))))))))))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id risk_code)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id max_timeband)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id code)))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_stfacs '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_stfacs_2')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs_2))))))) (select_statement (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id rf) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rf)) . (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id risk_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id max_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_facility)))))) (table_alias (identifier (id_expression (regular_id rf)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs)))))) (table_alias (identifier (id_expression (regular_id fts)))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rf)) . (id_expression (regular_id facility_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id code)))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_stfacs_2 '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs_2))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id rf) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rf)) . (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id risk_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id max_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_facility)))))) (table_alias (identifier (id_expression (regular_id rf)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_default_fac_type)))))) (table_alias (identifier (id_expression (regular_id dft)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs)))))) (table_alias (identifier (id_expression (regular_id fts)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rf)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id dft)) . (id_expression (regular_id raw_facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id dft)) . (id_expression (regular_id facility_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id fts)) . (id_expression (regular_id code))))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_stfacs_2--2 '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_stuniq')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stuniq))))))) (select_statement (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id risk_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id max_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs_2)))))))))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id facility_id)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id risk_code)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id max_timeband)))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_stuniq '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'limit_amount')))))))))))) )))) ; (statement (sql_statement (data_manipulation_language_statements (insert_statement insert (single_table_insert (insert_into_clause into (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id limit_amount))))))) (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (regular_id st) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id risk_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id max_timeband))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id la)) . (id_expression (regular_id time_band_key)))))))))))))))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs_2)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_limit_amount)))))) (table_alias (identifier (id_expression (regular_id la)))))))) (where_clause where (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id la)) . (id_expression (regular_id raw_facility_id)))))))))))))))))))))))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into limit_amount '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_os_amount')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_os_amount))))))) (select_statement (subquery (subquery_basic_elements (query_block SELECT DISTINCT (selected_element (select_list_elements (regular_id rof) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id risk_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id max_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stuniq)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_outstanding_fac)))))) (table_alias (identifier (id_expression (regular_id rof)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_outstanding_amount)))))) (table_alias (identifier (id_expression (regular_id oa)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rof)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rof)) . (id_expression (regular_id raw_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id raw_outstanding_id))))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_os_amount '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_limit_amount)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id la) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs_2)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_limit_amount)))))) (table_alias (identifier (id_expression (regular_id la)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id la)) . (id_expression (regular_id raw_facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id la)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id max_timeband))))))))))))))))))) )))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows deleted from pp_limit_amount '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_outstanding_amount)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id oa) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stuniq)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_outstanding_fac)))))) (table_alias (identifier (id_expression (regular_id rof)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_outstanding_amount)))))) (table_alias (identifier (id_expression (regular_id oa)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rof)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rof)) . (id_expression (regular_id raw_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id raw_outstanding_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id max_timeband))))))))))))))))))) )))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows deleted from pp_outstanding_amount '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_netted_outstanding_amount)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id oa) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stuniq)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_netted_outstanding_fac)))))) (table_alias (identifier (id_expression (regular_id rof)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_netted_outstanding_amount)))))) (table_alias (identifier (id_expression (regular_id oa)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_netted_outstanding)))))) (table_alias (identifier (id_expression (regular_id rno)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rof)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rof)) . (id_expression (regular_id raw_netted_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id raw_netted_outstanding_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rno)) . (id_expression (regular_id raw_netted_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id raw_netted_outstanding_id)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rno)) . (id_expression (regular_id outstanding_amount_type))))))))))) is not NULL)) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id max_timeband))))))))))))))))))) )))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows deleted from pp_netted_outstanding_amount '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id facility_amount_org)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id org) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id facility_amount_org)))))) (table_alias (identifier (id_expression (regular_id org)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs_2)))))) (table_alias (identifier (id_expression (regular_id st)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id max_timeband))))))))))))))))))) )))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows deleted from facility_amount_org '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id outstanding_amount_org)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id org) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id outstanding_amount_org)))))) (table_alias (identifier (id_expression (regular_id org)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_os_amount)))))) (table_alias (identifier (id_expression (regular_id st)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id raw_outstanding_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id max_timeband)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 15))))))))))))))))) )))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows deleted from outstanding_amount_org '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_rc')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rc))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id risk_code))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id delivered_timeband))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vortex_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id risk_categories)))))))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id delivered_timeband)))))))))) (relational_operator !=) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vortex_timeband)))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_rc '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement DELETE (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_limit_amount)))))) (where_clause WHERE (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c ROWID))))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id la) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_limit_amount)))))) (table_alias (identifier (id_expression (regular_id la)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id la)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator >) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 1))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id la)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator <) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 11)))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id)))))))) IN (in_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id raw_facility_id)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id raw_facility)))))) (table_alias (identifier (id_expression (regular_id rf)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id facility_type)))))) (table_alias (identifier (id_expression (regular_id ft)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rf)) . (id_expression (regular_id facility_type))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id highest_level_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'ST')))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id level_number)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 5)))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id ft)) . (id_expression (regular_id record_valid_until))))))))))) IS NULL))))))) ))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_starters_package_version)))))))))) (relational_operator !=) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string '2.2'))))))))))))))))) )))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into pp_limit_amount '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id pp_limit_amount)))) (table_alias (identifier (id_expression (regular_id la)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT distinct (selected_element (select_list_elements (regular_id la) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id rc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vortex_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stfacs_2)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_limit_amount)))))) (table_alias (identifier (id_expression (regular_id la)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rc)))))) (table_alias (identifier (id_expression (regular_id rc)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id raw_facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id la)) . (id_expression (regular_id raw_facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id risk_code)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id time_band_key)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id delivered_timeband)))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id la)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id time_band_key)))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id vortex_timeband))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows merged into pp_limit_amount '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id pp_outstanding_amount)))) (table_alias (identifier (id_expression (regular_id oa)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT distinct (selected_element (select_list_elements (regular_id oa) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id rc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vortex_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id pp_outstanding_amount)))))) (table_alias (identifier (id_expression (regular_id oa)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_os_amount)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rc)))))) (table_alias (identifier (id_expression (regular_id rc)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id raw_outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id raw_outstanding_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id risk_code)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id delivered_timeband)))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id oa)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id time_band_key)))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id vortex_timeband))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' ERROR=> '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id SQLERRM)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows merged into pp_outstanding_amount '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id facility_amount_org)))) (table_alias (identifier (id_expression (regular_id org)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT distinct (selected_element (select_list_elements (regular_id org) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id rc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vortex_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id facility_amount_org)))))) (table_alias (identifier (id_expression (regular_id org)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_stuniq)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rc)))))) (table_alias (identifier (id_expression (regular_id rc)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id facility_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id facility_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id risk_code)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id time_band_key)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id delivered_timeband)))))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id time_band_key)))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id vortex_timeband))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows merged into facility_amount_org '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (merge_statement MERGE INTO (tableview_name (identifier (id_expression (regular_id outstanding_amount_org)))) (table_alias (identifier (id_expression (regular_id org)))) USING (selected_tableview ( (select_statement (subquery (subquery_basic_elements (query_block SELECT distinct (selected_element (select_list_elements (regular_id org) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c rowid)))))))))))))))) (column_alias (identifier (id_expression (regular_id row_id))))) , (selected_element (select_list_elements (regular_id rc) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id vortex_timeband)))))))))))))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id outstanding_amount_org)))))) (table_alias (identifier (id_expression (regular_id org)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_os_amount)))))) (table_alias (identifier (id_expression (regular_id st)))))) , (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_rc)))))) (table_alias (identifier (id_expression (regular_id rc)))))))) (where_clause WHERE (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id raw_outstanding_id))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id risk_code)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id st)) . (id_expression (regular_id risk_code)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id delivered_timeband)))))))))))))) AND (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id rc)) . (id_expression (regular_id delivered_timeband)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 15)))))))))))))))))) ) (table_alias (identifier (id_expression (regular_id src))))) ON ( (condition (expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id org)) . (id_expression (regular_id (non_reserved_keywords_pre12c rowid))))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id row_id))))))))))))))) ) (merge_update_clause WHEN MATCHED THEN UPDATE SET (merge_element (column_name (identifier (id_expression (regular_id time_band_key)))) = (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id src)) . (id_expression (regular_id vortex_timeband))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows merged into outstanding_amount_org '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_temp_osa')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_osa))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id amo) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amo)) . (id_expression (regular_id netting_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amo)) . (id_expression (regular_id amount_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amo)) . (id_expression (regular_id time_band_key))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amo)) . (id_expression (regular_id currency))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amo)) . (id_expression (regular_id outstanding_amount))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id utils)) . (id_expression (regular_id convert_to_number)) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amo)) . (id_expression (regular_id outstanding_amount)))))))) / (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id uer)) . (id_expression (regular_id exchange_rate_per_euro))))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 22)))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (numeric 2)))))))))))) ))))))))))))))) (column_alias (identifier (id_expression (regular_id outstanding_amount_base))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id outstanding_amount_org)))))) (table_alias (identifier (id_expression (regular_id amo))))) (join_clause JOIN (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id upload_exchange_rate)))))) (table_alias (identifier (id_expression (regular_id uer))))) (join_on_part ON (condition (expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amo)) . (id_expression (regular_id currency)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id uer)) . (id_expression (regular_id currency_code))))))))))))) AND (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount_type)))))))) IN (in_elements ( (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OPVO')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OMVO')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OLEO')))))) ))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_temp_osa '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id truncate_table))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'tt_osa_max_amt')))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement INSERT (single_table_insert (insert_into_clause INTO (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_osa_max_amt))))))) (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements (query_block SELECT (selected_element (select_list_elements (regular_id osa) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id netting_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id amount_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function MAX ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id outstanding_amount_base))))))))))))) )))))))))))))) (column_alias (identifier (id_expression (regular_id max_amount))))) (from_clause FROM (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_osa)))))) (table_alias (identifier (id_expression (regular_id osa)))))))) (group_by_clause GROUP BY (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id outstanding_id)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id netting_type)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id amount_type)))))))))))))))))) ))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (concatenation (concatenation (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_line)))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' of plsql unit '))))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit))))))))) | | (concatenation (model_expression (unary_expression (atom (constant (quoted_string ' rows inserted into tt_osa_max_amt '))))))) | | (concatenation (model_expression (unary_expression (standard_function (other_function (cursor_name (general_element (general_element_part (id_expression (regular_id (non_reserved_keywords_pre12c SQL)))))) %rowcount))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_msg)))))))))))))) )))) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (insert_statement insert (single_table_insert (insert_into_clause into (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_osa_mx_amt_timeband))))))) (select_statement (subquery (subquery_basic_elements (query_block select (selected_element (select_list_elements (regular_id osa) . (expressions (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id outstanding_id))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id amount_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id netting_type))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id outstanding_amount_base))))))))))))) , (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (standard_function (numeric_function_wrapper (numeric_function max ( (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id time_band_key))))))))))))) )))))))))))))) (column_alias as (identifier (id_expression (regular_id time_band_key))))) (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_osa_max_amt)))))) (table_alias (identifier (id_expression (regular_id t))))) (join_clause join (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_temp_osa)))))) (table_alias (identifier (id_expression (regular_id osa))))) (join_on_part on (condition (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id outstanding_id))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id amount_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id amount_type)))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id netting_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id netting_type)))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id outstanding_amount_base)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id max_amount))))))))))))))))))))) (group_by_clause group by (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id outstanding_id)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id amount_type)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id netting_type)))))))))))))) , (group_by_elements (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id osa)) . (id_expression (regular_id outstanding_amount_base)))))))))))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id dbms_output))) . (id_expression (regular_id put_line))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (body BEGIN (seq_of_statements (statement (sql_statement (data_manipulation_language_statements (delete_statement delete from (general_table_ref (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id outstanding_amount_org)))))) (where_clause where (expression (logical_expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id amount_type)))))))) in (in_elements ( (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OPVO')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OMVO')))))) , (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'OLEO')))))) )))))) and (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (quantified_expression exists ( (subquery (subquery_basic_elements (query_block select * (from_clause from (table_ref_list (table_ref (table_ref_aux (table_ref_aux_internal (dml_table_expression_clause (tableview_name (identifier (id_expression (regular_id tt_osa_mx_amt_timeband)))))) (table_alias (identifier (id_expression (regular_id t)))))))) (where_clause where (expression (logical_expression (logical_expression (logical_expression (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id outstanding_amount_org)) . (id_expression (regular_id outstanding_id)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id outstanding_id))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id outstanding_amount_org)) . (id_expression (regular_id netting_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id netting_type)))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id outstanding_amount_org)) . (id_expression (regular_id amount_type)))))))))) (relational_operator =) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id amount_type)))))))))))))) and (logical_expression (multiset_expression (relational_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id outstanding_amount_org)) . (id_expression (regular_id time_band_key)))))))))) (relational_operator <>) (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id t)) . (id_expression (regular_id time_band_key))))))))))))))))))) )))))))))))))))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END)) ; (statement (function_call (routine_name (identifier (id_expression (regular_id utilities))) . (id_expression (regular_id log_msg))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_procname)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'end')))))))))))) )))) ; (statement (assignment_statement (general_element (general_element_part (id_expression (regular_id v_debug_msg)))) := (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (concatenation (model_expression (unary_expression (atom (constant (quoted_string 'END OF PLSQL UNIT ')))))) | | (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id plsql_unit)))))))))))))))) ; (statement (function_call (routine_name (identifier (id_expression (regular_id UTILITIES))) . (id_expression (regular_id show_debug))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id v_debug_msg)))))))))))))) )))) ;) EXCEPTION (exception_handler WHEN (exception_name (identifier (id_expression (regular_id OTHERS)))) THEN (seq_of_statements (statement (function_call (routine_name (identifier (id_expression (regular_id utils))) . (id_expression (regular_id handleerror))) (function_argument ( (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlcode)))))))))))))) , (argument (expression (logical_expression (multiset_expression (relational_expression (compound_expression (concatenation (model_expression (unary_expression (atom (general_element (general_element_part (id_expression (regular_id sqlerrm)))))))))))))) )))) ;)) END) ;)) (sql_plus_command /) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c show))))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c error))))))) ; <EOF>)
D:\projects\plsqlcode\change_timebands.sql.out
(sql_script (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements sql_script ( (subquery (subquery_basic_elements unit_statement ( (subquery subquery_basic_elements))) create_procedure_body)) <missing ')'>))))) (unit_statement (create_procedure_body create or replace PROCEDURE (procedure_name (identifier ( (id_expression (regular_id procedure_name)))) ( (parameter (parameter_name (identifier (id_expression (regular_id (non_reserved_keywords_pre12c identifier)))))))) (unit_statement (data_manipulation_language_statements (select_statement (subquery (subquery_basic_elements ( (subquery (subquery_basic_elements id_expression ( (subquery subquery_basic_elements))) <missing ')'>))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id regular_id)))))) (unit_statement (procedure_call (routine_name (identifier (id_expression (regular_id change_timebands)))))) ) ) ) ) ( ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_system_id ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id systemid ) ) ) ) ) , ( parameter ( parameter_name ( identifier ( id_expression ( regular_id v_reporting_date ) ) ) ) IN ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id reportingdate ) ) ) ) ) ) AS ( seq_of_declare_specs ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_starters_package_version ) ) ) ( type_spec ( datatype ( native_datatype_element VARCHAR2 ) ( precision_part ( ( numeric 10 ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_procname ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id procname ) ) ) ) ( default_value_part := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'change_timebands' ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_msg ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id debug_msg ) ) ) ) ; ) ) ( declare_spec ( variable_declaration ( identifier ( id_expression ( regular_id v_debug_msg ) ) ) ( type_spec ( type_name ( id_expression ( regular_id pkg_subtype ) ) . ( id_expression ( regular_id debug_msg ) ) ) ) ; ) ) ) ( body BEGIN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'START OF PLSQL UNIT ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'start' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id starters_package_version ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( into_clause INTO ( variable_name ( id_expression ( regular_id v_starters_package_version ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id reporting_date_system_id ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id system_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_system_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id reporting_date ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id no_data_found ) ) ) ) THEN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_starters_package_version ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant null ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' value for v_starters_package_version ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_starters_package_version ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' OF PLSQL UNIT ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_facility_types' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_facility_types ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id ft ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( case_statement ( searched_case_statement CASE ( searched_case_when_part WHEN ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_starters_package_version ) ) ) ) ) ) ) ) ) ) ( relational_operator != ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '2.2' ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'ST' ) ) ) ) ) ) ) ) ) ) ) ) ) THEN ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function MAX ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id risk_categories ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( case_else_part ELSE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function MAX ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id delivered_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id risk_categories ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) END ( label_name ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id risk_categories ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rc ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id facility_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ft ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id record_valid_from ) ) ) ) ) ) ) ) ) ) ( relational_operator < = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id level_number ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( ( expressions ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) OR ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_reporting_date ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_facility_types ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' OF PLSQL UNIT ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_stfacs' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id fts ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id facility_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ft ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_facility_types ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id fts ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id highest_level_key ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id facility_type_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_stfacs ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_stfacs_2' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs_2 ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id rf ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rf ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rf ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id fts ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rf ) ) . ( id_expression ( regular_id facility_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_stfacs_2 ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs_2 ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id rf ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rf ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rf ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_default_fac_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id dft ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id fts ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rf ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id dft ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id dft ) ) . ( id_expression ( regular_id facility_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id fts ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_stfacs_2--2 ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_stuniq' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stuniq ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs_2 ) ) ) ) ) ) ) ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_stuniq ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'limit_amount' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement insert ( single_table_insert ( insert_into_clause into ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id limit_amount ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( regular_id st ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id la ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs_2 ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_limit_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id la ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id la ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into limit_amount ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_os_amount' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_os_amount ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT DISTINCT ( selected_element ( select_list_elements ( regular_id rof ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stuniq ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_outstanding_fac ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rof ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_outstanding_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id oa ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rof ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rof ) ) . ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_os_amount ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_limit_amount ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id la ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs_2 ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_limit_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id la ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id la ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id la ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows deleted from pp_limit_amount ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_outstanding_amount ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id oa ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stuniq ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_outstanding_fac ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rof ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_outstanding_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id oa ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rof ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rof ) ) . ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows deleted from pp_outstanding_amount ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_netted_outstanding_amount ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id oa ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stuniq ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_netted_outstanding_fac ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rof ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_netted_outstanding_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id oa ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_netted_outstanding ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rno ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rof ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rof ) ) . ( id_expression ( regular_id raw_netted_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id raw_netted_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rno ) ) . ( id_expression ( regular_id raw_netted_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id raw_netted_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rno ) ) . ( id_expression ( regular_id outstanding_amount_type ) ) ) ) ) ) ) ) ) ) ) is not NULL ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows deleted from pp_netted_outstanding_amount ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id facility_amount_org ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id org ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id facility_amount_org ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id org ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs_2 ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows deleted from facility_amount_org ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id outstanding_amount_org ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id org ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id outstanding_amount_org ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id org ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_os_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id max_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 15 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows deleted from outstanding_amount_org ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_rc' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rc ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id delivered_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id risk_categories ) ) ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id delivered_timeband ) ) ) ) ) ) ) ) ) ) ( relational_operator != ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_rc ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement DELETE ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_limit_amount ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c ROWID ) ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id la ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_limit_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id la ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id la ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator > ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 1 ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id la ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator < ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 11 ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) IN ( in_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id raw_facility ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rf ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id facility_type ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id ft ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rf ) ) . ( id_expression ( regular_id facility_type ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id highest_level_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'ST' ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id level_number ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 5 ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ft ) ) . ( id_expression ( regular_id record_valid_until ) ) ) ) ) ) ) ) ) ) ) IS NULL ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_starters_package_version ) ) ) ) ) ) ) ) ) ) ( relational_operator != ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string '2.2' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into pp_limit_amount ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id pp_limit_amount ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id la ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT distinct ( selected_element ( select_list_elements ( regular_id la ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id rc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stfacs_2 ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_limit_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id la ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rc ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id la ) ) . ( id_expression ( regular_id raw_facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id delivered_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id la ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id time_band_key ) ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows merged into pp_limit_amount ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id pp_outstanding_amount ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id oa ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT distinct ( selected_element ( select_list_elements ( regular_id oa ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id rc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id pp_outstanding_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id oa ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_os_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rc ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id delivered_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id oa ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id time_band_key ) ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' ERROR=> ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id SQLERRM ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows merged into pp_outstanding_amount ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id facility_amount_org ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id org ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT distinct ( selected_element ( select_list_elements ( regular_id org ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id rc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id facility_amount_org ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id org ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_stuniq ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rc ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id facility_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id delivered_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id time_band_key ) ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows merged into facility_amount_org ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( merge_statement MERGE INTO ( tableview_name ( identifier ( id_expression ( regular_id outstanding_amount_org ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id org ) ) ) ) USING ( selected_tableview ( ( select_statement ( subquery ( subquery_basic_elements ( query_block SELECT distinct ( selected_element ( select_list_elements ( regular_id org ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id row_id ) ) ) ) ) , ( selected_element ( select_list_elements ( regular_id rc ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id outstanding_amount_org ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id org ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_os_amount ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id st ) ) ) ) ) ) , ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_rc ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id rc ) ) ) ) ) ) ) ) ( where_clause WHERE ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id raw_outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id st ) ) . ( id_expression ( regular_id risk_code ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id delivered_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id rc ) ) . ( id_expression ( regular_id delivered_timeband ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 15 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id src ) ) ) ) ) ON ( ( condition ( expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id org ) ) . ( id_expression ( regular_id ( non_reserved_keywords_pre12c rowid ) ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id row_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( merge_update_clause WHEN MATCHED THEN UPDATE SET ( merge_element ( column_name ( identifier ( id_expression ( regular_id time_band_key ) ) ) ) = ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id src ) ) . ( id_expression ( regular_id vortex_timeband ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows merged into outstanding_amount_org ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_temp_osa' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_osa ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id amo ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amo ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amo ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amo ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amo ) ) . ( id_expression ( regular_id currency ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amo ) ) . ( id_expression ( regular_id outstanding_amount ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id utils ) ) . ( id_expression ( regular_id convert_to_number ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amo ) ) . ( id_expression ( regular_id outstanding_amount ) ) ) ) ) ) ) ) / ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id uer ) ) . ( id_expression ( regular_id exchange_rate_per_euro ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 22 ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( numeric 2 ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id outstanding_amount_base ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id outstanding_amount_org ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id amo ) ) ) ) ) ( join_clause JOIN ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id upload_exchange_rate ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id uer ) ) ) ) ) ( join_on_part ON ( condition ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amo ) ) . ( id_expression ( regular_id currency ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id uer ) ) . ( id_expression ( regular_id currency_code ) ) ) ) ) ) ) ) ) ) ) ) ) AND ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) IN ( in_elements ( ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OPVO' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OMVO' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OLEO' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_temp_osa ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id truncate_table ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'tt_osa_max_amt' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement INSERT ( single_table_insert ( insert_into_clause INTO ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_osa_max_amt ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( ( subquery ( subquery_basic_elements ( query_block SELECT ( selected_element ( select_list_elements ( regular_id osa ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function MAX ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id outstanding_amount_base ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias ( identifier ( id_expression ( regular_id max_amount ) ) ) ) ) ( from_clause FROM ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_osa ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id osa ) ) ) ) ) ) ) ) ( group_by_clause GROUP BY ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( concatenation ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_line ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' of plsql unit ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string ' rows inserted into tt_osa_max_amt ' ) ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( standard_function ( other_function ( cursor_name ( general_element ( general_element_part ( id_expression ( regular_id ( non_reserved_keywords_pre12c SQL ) ) ) ) ) ) %rowcount ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( insert_statement insert ( single_table_insert ( insert_into_clause into ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_osa_mx_amt_timeband ) ) ) ) ) ) ) ( select_statement ( subquery ( subquery_basic_elements ( query_block select ( selected_element ( select_list_elements ( regular_id osa ) . ( expressions ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id outstanding_amount_base ) ) ) ) ) ) ) ) ) ) ) ) ) , ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( standard_function ( numeric_function_wrapper ( numeric_function max ( ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( column_alias as ( identifier ( id_expression ( regular_id time_band_key ) ) ) ) ) ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_osa_max_amt ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ( join_clause join ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_temp_osa ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id osa ) ) ) ) ) ( join_on_part on ( condition ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id outstanding_amount_base ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id max_amount ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ( group_by_clause group by ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( group_by_elements ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id osa ) ) . ( id_expression ( regular_id outstanding_amount_base ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id dbms_output ) ) ) . ( id_expression ( regular_id put_line ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( body BEGIN ( seq_of_statements ( statement ( sql_statement ( data_manipulation_language_statements ( delete_statement delete from ( general_table_ref ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id outstanding_amount_org ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) in ( in_elements ( ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OPVO' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OMVO' ) ) ) ) ) ) , ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'OLEO' ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( quantified_expression exists ( ( subquery ( subquery_basic_elements ( query_block select * ( from_clause from ( table_ref_list ( table_ref ( table_ref_aux ( table_ref_aux_internal ( dml_table_expression_clause ( tableview_name ( identifier ( id_expression ( regular_id tt_osa_mx_amt_timeband ) ) ) ) ) ) ( table_alias ( identifier ( id_expression ( regular_id t ) ) ) ) ) ) ) ) ( where_clause where ( expression ( logical_expression ( logical_expression ( logical_expression ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id outstanding_amount_org ) ) . ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id outstanding_id ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id outstanding_amount_org ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id netting_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id outstanding_amount_org ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ( relational_operator = ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id amount_type ) ) ) ) ) ) ) ) ) ) ) ) ) ) and ( logical_expression ( multiset_expression ( relational_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id outstanding_amount_org ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ( relational_operator <> ) ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id t ) ) . ( id_expression ( regular_id time_band_key ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utilities ) ) ) . ( id_expression ( regular_id log_msg ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_procname ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'end' ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( assignment_statement ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) := ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( concatenation ( model_expression ( unary_expression ( atom ( constant ( quoted_string 'END OF PLSQL UNIT ' ) ) ) ) ) ) | | ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id plsql_unit ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id UTILITIES ) ) ) . ( id_expression ( regular_id show_debug ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id v_debug_msg ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) EXCEPTION ( exception_handler WHEN ( exception_name ( identifier ( id_expression ( regular_id OTHERS ) ) ) ) THEN ( seq_of_statements ( statement ( function_call ( routine_name ( identifier ( id_expression ( regular_id utils ) ) ) . ( id_expression ( regular_id handleerror ) ) ) ( function_argument ( ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlcode ) ) ) ) ) ) ) ) ) ) ) ) ) ) , ( argument ( expression ( logical_expression ( multiset_expression ( relational_expression ( compound_expression ( concatenation ( model_expression ( unary_expression ( atom ( general_element ( general_element_part ( id_expression ( regular_id sqlerrm ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ) ; ) ) END ) ; ) ) ( sql_plus_command / ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c show ) ) ) ) ) ) ) ( unit_statement ( procedure_call ( routine_name ( identifier ( id_expression ( regular_id ( non_reserved_keywords_pre12c error ) ) ) ) ) ) ) ; < EOF > ))
